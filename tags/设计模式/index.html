<!DOCTYPE HTML>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
  
  <title>设计模式 | Aaron Wu</title>
  <meta name="author" content="Aaron Wu">
  
  <meta name="description" content="Aaron Wu">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
  <meta property="og:site_name" content="Aaron Wu">

  
    <meta property="og:image" content="undefined">
  

  
  
    <link href="/favicon.png" rel="icon">
  

  <!-- CSS -->
  <link rel="stylesheet" href="/css/themes/cerulean.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/responsive.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight-default.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/comment.css" media="screen" type="text/css">
  <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.9/es5-shim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.7/es5-sham.min.js"></script>
  <![endif]-->

  <script src="/js/jquery-2.0.3.min.js"></script>
  
    <script src="/js/marked.js"></script>
    <script src="/js/comment.js"></script>
    <script src="/js/timeago.min.js"></script>
    <script src="/js/highlight.min.js"></script>
	<script src="/js/spin.min.js"></script>
  
  <!-- analytics --><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  



</head>

<body>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><nav id="main-nav" class="navbar navbar-inverse navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
      <button type="button" class="navbar-header navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
	<span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
       <a class="navbar-brand" href="/">Aaron Wu</a>
      <div class="collapse navbar-collapse nav-menu">
		<ul class="nav navbar-nav">
		  
		  <li>
			<a href="/archives" title="All the articles.">
			  <i class="fa fa-archive"></i>Archives
			</a>
		  </li>
		  
		  <li>
			<a href="/categories" title="All the categories.">
			  <i class="fa fa-folder"></i>Categories
			</a>
		  </li>
		  
		  <li>
			<a href="/tags" title="All the tags.">
			  <i class="fa fa-tags"></i>Tags
			</a>
		  </li>
		  
		  <li>
			<a href="/about" title="About me.">
			  <i class="fa fa-user"></i>About
			</a>
		  </li>
		  
		</ul>
      </div>
    </div> <!-- container -->
</nav>
<div class="clearfix"></div>

  <div class="container">
    <div class="content">
      

<!-- title -->
<div class="page-header page-header-inverse ">
  <h1 class="archive-title-tag title title-inverse ">设计模式</h1>
</div>

<div class="row page">
  <!-- cols -->
  
  <div class="col-md-9">
	

	  <div id="top_search"></div>

      
         <!-- display as entry -->
	     <div class="mypage">
	       
		     
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2017-06-10 </div>
			<div class="article-title"><a href="/2017/06/10/设计模式——工厂模式（2）：工厂方法模式/" title="本文为工厂模式整理的第二篇，主要介绍工厂方法模式。工厂方法模式是面向对象编程中常用的一种模式，它能够使代码结构清晰，降低耦合度。">设计模式——工厂模式（2）：工厂方法模式</a></div>						
		</h3>
	


		     <div class="entry">
  <div class="row">
	
	
		<p>&emsp;&emsp;工厂模式根据其抽象程度的逐步提高可以分为简单工厂、工厂方法模式和抽象工厂模式。关于简单工厂，可以移步我的另一篇博文<a href="/2017/06/01/设计模式——工厂模式（1）：简单工厂/">设计模式——工厂模式（1）：简单工厂</a>。本文介绍第二种：工厂方法模式。<br><code>注意：本文中所提到的“接口”，并非仅指java中的interface，也包括抽象类、抽象方法等。</code></p>
<h1 id="工厂方法模式概念"><a href="#工厂方法模式概念" class="headerlink" title="工厂方法模式概念"></a>工厂方法模式概念</h1><p>&emsp;&emsp;工厂方法模式定义了一个创建产品对象的工厂接口，由子类决定要实例化的类是哪一个，它将实际创建工作推迟到子类当中。核心工厂类成为一个抽象工厂角色，仅表示具体工厂子类必须实现的接口。工厂方法模式是简单工厂基础上的进一步抽象，进一步抽象化的好处是使得工厂方法模式可以使系统在不修改具体工厂角色的情况下引进新的产品或者是增加新的工厂。<br>&emsp;&emsp;工厂方法模式的<strong>核心思想是：封装类中不变的部分，提取其中个性化善变的部分为独立类，通过依赖注入以达到解耦、复用和方便后期维护拓展的目的。</strong></p>
<h1 id="工厂方法模式要素"><a href="#工厂方法模式要素" class="headerlink" title="工厂方法模式要素"></a>工厂方法模式要素</h1><p>&emsp;&emsp;工厂方法模式共有四个要素，如下图所示：  </p>
<p align="center"><br><img src="http://odnk9as2f.bkt.clouddn.com/FactoryMethodPattern1.png" alt="工厂方法模式要素"><br></p>

<p>具体要素为：  </p>
<ul>
<li>工厂接口<em><code>Creator</code></em>，它是工厂方法模式的核心。它实现了操纵产品的方法<code>anOperation()</code>，同时定义了一个抽象的<strong>工厂方法*</strong><code>factoryMethod()</code>*，它不实现工厂方法而是留给子类去实现。</li>
<li>具体工厂实现<code>ConcretCreator</code>，它实现了工厂接口的抽象的工厂方法<code>factoryMethod()</code>，以决定如何创造具体的产品。有多少种产品，就要有多少个具体的工厂实现。</li>
<li>产品接口<em><code>Product</code></em>，它定义了产品的规范，所有产品必须实现这个共同的接口，这样一来使用这些产品的类就可以引用这个接口，而不是具体类。调用者关心的是产品接口而非具体的产品。</li>
<li>具体产品实现<code>ConcretProduct</code>，它是实现产品的具体类。</li>
</ul>
<h1 id="工厂方法模式示例"><a href="#工厂方法模式示例" class="headerlink" title="工厂方法模式示例"></a>工厂方法模式示例</h1><p>&emsp;&emsp;根据上一节中的工厂方法模式的四要素，我们假设这样一个场景：比萨类型有两个种类：<strong>纽约风味比萨</strong>和<strong>芝加哥风味比萨</strong>，不同的风味下又各有四个不同原料的比萨，纽约和芝加哥两地均有比萨店的分店，需要提供以上两类的四个不同原料的比萨。让我们来看看类图：</p>
<p></p><p align="center"><br><img src="http://odnk9as2f.bkt.clouddn.com/FactoryMethodPattern2.png" alt="Pizza工厂示例类图"><br></p><br>&emsp;&emsp;下面将以令纽约比萨分店<code>NYStylePizzaStore</code>创建纽约风味的cheese比萨<code>NYStyleCheesePizza</code>为例，来实现我们的工厂方法模式的demo：<p></p>
<ul>
<li>工厂接口：<em><code>PizzaStore</code></em>类：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.edu.whu;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 抽象工厂类</span></span><br><span class="line"><span class="comment"> * Created by wuwenan on 10/06/2017.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">PizzaStore</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Pizza <span class="title">orderPizza</span><span class="params">(String type)</span> </span>&#123;</span><br><span class="line">        Pizza pizza;</span><br><span class="line"></span><br><span class="line">        pizza = createPizza(type);</span><br><span class="line"></span><br><span class="line">        pizza.prepare();</span><br><span class="line">        pizza.bake();</span><br><span class="line">        pizza.cut();</span><br><span class="line">        pizza.box();</span><br><span class="line">        <span class="keyword">return</span> pizza;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//工厂方法，让子类实现</span></span><br><span class="line">    <span class="function"><span class="keyword">abstract</span> Pizza <span class="title">createPizza</span><span class="params">(String type)</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>具体工厂实现类：<code>NYStylePizzaStore</code>：  </li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.edu.whu;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 具体工厂类</span></span><br><span class="line"><span class="comment"> * Created by wuwenan on 10/06/2017.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NYStylePizzaStore</span> <span class="keyword">extends</span> <span class="title">PizzaStore</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function">Pizza <span class="title">createPizza</span><span class="params">(String item)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (item.equals(<span class="string">"cheese"</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> NYStyleCheesePizza();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (item.equals(<span class="string">"veggie"</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> NYStyleVeggiePizza();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (item.equals(<span class="string">"clam"</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> NYStyleClamPizza();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (item.equals(<span class="string">"pepperoni"</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> NYStylePepperoniPizza();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>产品接口：<em><code>Pizza</code></em>类：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.edu.whu;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 抽象产品类</span></span><br><span class="line"><span class="comment"> * Created by wuwenan on 02/06/2017.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Pizza</span> </span>&#123;</span><br><span class="line">    String name; <span class="comment">//比萨名</span></span><br><span class="line">    String dough; <span class="comment">//使用的面团</span></span><br><span class="line">    String sauce; <span class="comment">//使用的酱料</span></span><br><span class="line">    ArrayList toppings = <span class="keyword">new</span> ArrayList(); <span class="comment">//使用的佐料</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">prepare</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Preparing "</span> + name);</span><br><span class="line">        System.out.println(<span class="string">"Tossing dough..."</span>);</span><br><span class="line">        System.out.println(<span class="string">"Adding sauce..."</span>);</span><br><span class="line">        System.out.println(<span class="string">"Adding toppings: "</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;toppings.size();i++) &#123;</span><br><span class="line">            System.out.println(<span class="string">"  "</span> + toppings.get(i));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">bake</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Baking..."</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">cut</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Cutting the pizza..."</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">box</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Placing the pizza in box..."</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>具体产品实现类：<code>NYStyleCheesePizza</code>  </li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.edu.whu;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 具体产品类</span></span><br><span class="line"><span class="comment"> * Created by wuwenan on 10/06/2017.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NYStyleCheesePizza</span> <span class="keyword">extends</span> <span class="title">Pizza</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">NYStyleCheesePizza</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        name = <span class="string">"NY Style Cheese Pizza"</span>;</span><br><span class="line">        dough = <span class="string">"NY Style Cheese Pizza dough"</span>;</span><br><span class="line">        sauce = <span class="string">"NY Style Cheese Pizza sauce"</span>;</span><br><span class="line"></span><br><span class="line">        toppings.add(<span class="string">"NY Style Cheese Pizza topping1"</span>);</span><br><span class="line">        toppings.add(<span class="string">"NY Style Cheese Pizza topping2"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>测试类：<code>PizzaTest</code></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.edu.whu;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 测试类</span></span><br><span class="line"><span class="comment"> * Created by wuwenan on 10/06/2017.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PizzaTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        PizzaStore nyPizzaStore = <span class="keyword">new</span> NYStylePizzaStore();</span><br><span class="line">        String pizzaType = <span class="string">"cheese"</span>;</span><br><span class="line">        System.out.println(<span class="string">"要创建的比萨类型是："</span> + pizzaType);</span><br><span class="line">        nyPizzaStore.orderPizza(pizzaType);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>输出结果为：  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">要创建的比萨类型是：cheese</span><br><span class="line">Preparing NY Style Cheese Pizza</span><br><span class="line">Tossing dough...</span><br><span class="line">Adding sauce...</span><br><span class="line">Adding toppings: </span><br><span class="line">  NY Style Cheese Pizza topping1</span><br><span class="line">  NY Style Cheese Pizza topping2</span><br><span class="line">Baking...</span><br><span class="line">Cutting the pizza...</span><br><span class="line">Placing the pizza in box...</span><br></pre></td></tr></table></figure>
<p>PS：以上代码已上传至我的Github，地址是：<a href="https://github.com/Wanz2/DesignPatterns" target="_blank" rel="noopener">https://github.com/Wanz2/DesignPatterns</a></p>

	
	</div>
  <a type="button" href="/2017/06/10/设计模式——工厂模式（2）：工厂方法模式/#more" class="btn btn-default more">阅读此文</a>
</div>

	       
		     
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2017-06-01 </div>
			<div class="article-title"><a href="/2017/06/01/设计模式——工厂模式（1）：简单工厂/" title="工厂模式共分为三类，简单工厂、工厂方法模式和抽象工厂模式。本文介绍第一种，简单工厂。">设计模式——工厂模式（1）：简单工厂</a></div>						
		</h3>
	


		     <div class="entry">
  <div class="row">
	
	
		<p>&emsp;&emsp;工厂模式共分为三类，简单工厂（Simple Factory）、工厂方法模式（Factory Method Pattern）和抽象工厂模式（Abstract Factory Pattern）。本文介绍第一种，简单工厂。<br>&emsp;&emsp;简单工厂严格来说不是一个设计模式，反而像是一种编程习惯，但它是工厂方法模式和抽象工厂模式的基础，因此非常重要。  </p>
<h2 id="简单工厂的概念"><a href="#简单工厂的概念" class="headerlink" title="简单工厂的概念"></a>简单工厂的概念</h2><p>&emsp;&emsp;简单工厂的类图如下： </p>
<p><img src="http://odnk9as2f.bkt.clouddn.com/SimpleFactory.png"></p>  

<p>&emsp;&emsp;简单工厂由以下几个类组成：  </p>
<ul>
<li>客户端：负责调用简单工厂类创建具体产品类的对象</li>
<li>简单工厂类：简单工厂类是简单工厂的核心，它负责处理创建对象的细节。它能够被客户端调用并创建所需要的产品对象。</li>
<li>抽象产品类：抽象产品类是简单工厂类所创建的所有产品类的父类，它可以是一个<strong>接口</strong>，也可以是一个<strong>抽象类</strong>。</li>
<li><p>具体产品类：具体产品类是简单工厂创建的具体产品对象，它们有着共同的父类——抽象产品类。</p>
<p>&emsp;&emsp;简单工厂的<strong>核心思想是：使用一个专门的类来负责创建实例的过程</strong>。当以后实现改变时，只需要修改这个类即可。<br>&emsp;&emsp;在实际使用中，需要注意以下几点：  </p>
</li>
</ul>
<ol>
<li>若具体产品之间没有共同的逻辑，则可以令抽象产品类为一个接口，令具体产品类实现该接口；若具体产品之间有共同的逻辑，则可以令抽象产品类为一个抽象类，封装具体产品类的共同逻辑。  </li>
<li>可以将简单工厂类中<strong>创建具体产品的方法</strong>定义为静态方法，这是一个很常见的技巧。使用静态方法的优点是在客户端中不需要实例化简单工厂类，缺点是不能通过继承来更改<strong>创建具体产品的方法</strong>的行为。  </li>
</ol>
<h2 id="简单工厂示例"><a href="#简单工厂示例" class="headerlink" title="简单工厂示例"></a>简单工厂示例</h2><p>&emsp;&emsp;假设有这样一个场景：有一个比萨店，需要制作各种类型的比萨，不同的比萨制作过程中有一些步骤是相同的，如：前期准备、烘烤、切片、装盒。但不同的比萨制作使用不同的材料。该案例的类图如下：  </p>
<p><img src="http://odnk9as2f.bkt.clouddn.com/SimpleFactory1.png"></p>  

<p>&emsp;&emsp;如上图所示，可以将创建比萨的方法<code>createPizza()</code>封装在一个单独类<code>SimplePizzaFactory</code>中，令<code>PizzaStore</code>类来调用<code>SimplePizzaFactory</code>来返回比萨对象。对于比萨对象，可以将各种比萨制作过程中的相同步骤封装在抽象类<code>Pizza</code>中，并将不同比萨特有的原料封装在各个子类中。<br>&emsp;&emsp;该案例的代码如下：  </p>
<ul>
<li>客户端类  </li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.edu.whu;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 客户端类</span></span><br><span class="line"><span class="comment"> * Created by wuwenan on 02/06/2017.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PizzaStore</span> </span>&#123;</span><br><span class="line">    SimplePizzaFactory factory;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">PizzaStore</span><span class="params">(SimplePizzaFactory factory)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.factory = factory;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Pizza <span class="title">orderPizza</span><span class="params">(String type)</span> </span>&#123;</span><br><span class="line">        Pizza pizza;</span><br><span class="line"></span><br><span class="line">        pizza = factory.createPizza(type);</span><br><span class="line"></span><br><span class="line">        pizza.prepare();</span><br><span class="line">        pizza.bake();</span><br><span class="line">        pizza.cut();</span><br><span class="line">        pizza.box();</span><br><span class="line">        <span class="keyword">return</span> pizza;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>简单工厂类</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.edu.whu;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 简单工厂类</span></span><br><span class="line"><span class="comment"> * Created by wuwenan on 02/06/2017.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SimplePizzaFactory</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Pizza <span class="title">createPizza</span><span class="params">(String type)</span> </span>&#123;</span><br><span class="line">        Pizza pizza = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (type.equals(<span class="string">"cheese"</span>)) &#123;</span><br><span class="line">            pizza = <span class="keyword">new</span> CheesePizza();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (type.equals(<span class="string">"veggie"</span>)) &#123;</span><br><span class="line">            pizza = <span class="keyword">new</span> VeggiePizza();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (type.equals(<span class="string">"clam"</span>)) &#123;</span><br><span class="line">            pizza = <span class="keyword">new</span> ClamPizza();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (type.equals(<span class="string">"pepperoni"</span>)) &#123;</span><br><span class="line">            pizza = <span class="keyword">new</span> PepperoniPizza();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> pizza;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>抽象产品类</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.edu.whu;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 抽象产品类</span></span><br><span class="line"><span class="comment"> * Created by wuwenan on 02/06/2017.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Pizza</span> </span>&#123;</span><br><span class="line">    String name; <span class="comment">//比萨名</span></span><br><span class="line">    String dough; <span class="comment">//使用的面团</span></span><br><span class="line">    String sauce; <span class="comment">//使用的酱料</span></span><br><span class="line">    ArrayList toppings = <span class="keyword">new</span> ArrayList(); <span class="comment">//使用的佐料</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">prepare</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Preparing "</span> + name);</span><br><span class="line">        System.out.println(<span class="string">"Tossing dough..."</span>);</span><br><span class="line">        System.out.println(<span class="string">"Adding sauce..."</span>);</span><br><span class="line">        System.out.println(<span class="string">"Adding toppings: "</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;toppings.size();i++) &#123;</span><br><span class="line">            System.out.println(<span class="string">"  "</span> + toppings.get(i));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">bake</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Baking..."</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">cut</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Cutting the pizza..."</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">box</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Placing the pizza in box..."</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>具体产品类</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.edu.whu;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 具体产品类</span></span><br><span class="line"><span class="comment"> * Created by wuwenan on 02/06/2017.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CheesePizza</span> <span class="keyword">extends</span> <span class="title">Pizza</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CheesePizza</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        name = <span class="string">"Cheese Pizza"</span>;</span><br><span class="line">        dough = <span class="string">"Cheese Pizza dough"</span>;</span><br><span class="line">        sauce = <span class="string">"Cheese Pizza sauce"</span>;</span><br><span class="line"></span><br><span class="line">        toppings.add(<span class="string">"Cheese Pizza topping1"</span>);</span><br><span class="line">        toppings.add(<span class="string">"Cheese Pizza topping2"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">VeggiePizza</span> <span class="keyword">extends</span> <span class="title">Pizza</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">VeggiePizza</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        name = <span class="string">"Veggie Pizza"</span>;</span><br><span class="line">        dough = <span class="string">"Veggie Pizza dough"</span>;</span><br><span class="line">        sauce = <span class="string">"Veggie Pizza sauce"</span>;</span><br><span class="line"></span><br><span class="line">        toppings.add(<span class="string">"Veggie Pizza topping1"</span>);</span><br><span class="line">        toppings.add(<span class="string">"Veggie Pizza topping2"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ClamPizza</span> <span class="keyword">extends</span> <span class="title">Pizza</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ClamPizza</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        name = <span class="string">"Clam Pizza"</span>;</span><br><span class="line">        dough = <span class="string">"Clam Pizza dough"</span>;</span><br><span class="line">        sauce = <span class="string">"Clam Pizza sauce"</span>;</span><br><span class="line"></span><br><span class="line">        toppings.add(<span class="string">"Clam Pizza topping1"</span>);</span><br><span class="line">        toppings.add(<span class="string">"Clam Pizza topping2"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PepperoniPizza</span> <span class="keyword">extends</span> <span class="title">Pizza</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">PepperoniPizza</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        name = <span class="string">"Pepperoni Pizza"</span>;</span><br><span class="line">        dough = <span class="string">"Pepperoni Pizza dough"</span>;</span><br><span class="line">        sauce = <span class="string">"Pepperoni Pizza sauce"</span>;</span><br><span class="line"></span><br><span class="line">        toppings.add(<span class="string">"Pepperoni Pizza topping1"</span>);</span><br><span class="line">        toppings.add(<span class="string">"Pepperoni Pizza topping2"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>测试类，这里仅用创建CheesePizza类型的比萨来测试：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PizzaTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SimplePizzaFactory simpleFactory = <span class="keyword">new</span> SimplePizzaFactory();</span><br><span class="line">        PizzaStore pizzaStore = <span class="keyword">new</span> PizzaStore(simpleFactory);</span><br><span class="line">        String pizzaType = <span class="string">"cheese"</span>;</span><br><span class="line">        System.out.println(<span class="string">"要创建的pizza类型是："</span> + pizzaType);</span><br><span class="line">        pizzaStore.orderPizza(pizzaType);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>运行结果：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">要创建的pizza类型是：cheese</span><br><span class="line">Preparing Cheese Pizza</span><br><span class="line">Tossing dough...</span><br><span class="line">Adding sauce...</span><br><span class="line">Adding toppings: </span><br><span class="line">  Cheese Pizza topping1</span><br><span class="line">  Cheese Pizza topping2</span><br><span class="line">Baking...</span><br><span class="line">Cutting the pizza...</span><br><span class="line">Placing the pizza in box...</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;若将简单工厂类中的工厂方法修改为静态方法，则可以将<code>SimplePizzaFactory</code>类中的<code>createPizza()</code>方法改写为：  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Pizza <span class="title">createPizza</span><span class="params">(String type)</span></span>&#123;</span><br><span class="line">	<span class="comment">//具体的创建步骤...</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>然后将客户端的<code>PizzaStore</code>方法改写为：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PizzaStore</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Pizza <span class="title">orderPizza</span><span class="params">(String type)</span> </span>&#123;</span><br><span class="line">        Pizza pizza;</span><br><span class="line"></span><br><span class="line">        pizza = SimplePizzaFactory.createPizza(type);</span><br><span class="line"></span><br><span class="line">        pizza.prepare();</span><br><span class="line">        pizza.bake();</span><br><span class="line">        pizza.cut();</span><br><span class="line">        pizza.box();</span><br><span class="line">        <span class="keyword">return</span> pizza;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>同样可以得到测试的结果。<br>PS：以上代码已上传至我的Github，地址是：<a href="https://github.com/Wanz2/DesignPatterns" target="_blank" rel="noopener">https://github.com/Wanz2/DesignPatterns</a></p>

	
	</div>
  <a type="button" href="/2017/06/01/设计模式——工厂模式（1）：简单工厂/#more" class="btn btn-default more">阅读此文</a>
</div>

	       
		     
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2017-05-31 </div>
			<div class="article-title"><a href="/2017/05/31/设计模式——模板方法模式/" title="模板方法模式是最常用的设计模式，本文对模板方法模式进行了介绍并通过案例对其进行分析。">设计模式——模板方法模式</a></div>						
		</h3>
	


		     <div class="entry">
  <div class="row">
	
	
		<p>&emsp;&emsp;模板方法模式是最常用的设计模式，本文对模板方法模式进行了介绍并通过案例对其进行分析。  </p>
<h2 id="模板方法模式的概念"><a href="#模板方法模式的概念" class="headerlink" title="模板方法模式的概念"></a>模板方法模式的概念</h2><p>&emsp;&emsp;模板方法模式（Template Method Pattern）的概念如下：  </p>
<blockquote>
<p>模板方法模式是类的行为模式。准备一个抽象类，将部分逻辑以具体方法以及具体构造函数的形式实现，然后声明一些抽象方法来迫使子类实现剩余的逻辑。不同的子类可以以不同的方式实现这些抽象方法，从而对剩余的逻辑有不同的实现。模板方法使得子类可以在不改变算法结构的情况下，重新定义算法中的某些步骤。  </p>
</blockquote>
<p>&emsp;&emsp;模板方法模式在很多地方都会用到，但看起来不一定会和标准的模板方法模式一样，我们这里先讲标准模板方法模式。模板方法模式的UML类图结构如下：    </p>
<p></p><p align="center"><br><img src="http://odnk9as2f.bkt.clouddn.com/AbstractClass.png" width="400px" name="模板方法模式类图"><br></p><br>如上图所示，模板方法模式中有两个类角色，分别是<strong>抽象类</strong>和<strong>具体类</strong>，这两个类的作用分别如下： <p></p>
<ul>
<li>抽象类<code>AbstractClass</code>：<ul>
<li>定义并实现了一个或多个<strong>模板方法</strong>，如上图中的<code>templateMethod()</code>。这个模板方法一般是一个具体方法，它给出了一个顶级逻辑的骨架，而逻辑的部分组成步骤在相应的抽象方法中，推迟到子类实现。顶级逻辑也有可能调用一些具体方法。顶级逻辑有着对于使用抽象方法和具体方法的决策权，而这个决策权存在于高层的抽象类中。注意，为了防止子类改变模板方法中的算法，可以将其声明为final。</li>
<li>定义了一个或多个<strong>具体方法</strong>，如上图中的<code>concreteOperation()</code>，这些具体方法可以是顶级逻辑中的组成部分，且不需要被子类实现或重写。</li>
<li>定义了一个或多个<strong>抽象方法</strong>，以便让子类实现，如上图中的<code>primitiveOperation1()</code>和<code>primitiveOperation2()</code>。这些抽象操作叫做基本操作，它们是一个顶级逻辑的组成步骤。</li>
<li>定义了一个<strong>钩子方法</strong>，如上图中的<code>hook()</code>。钩子方法声明在抽象类中，但只有空的或者默认的实现，钩子的存在可以让子类有能力对算法的不同点进行挂钩，具体是否要挂钩由子类自行决定。钩子方法的命名通常以do开头，如<code>HttpServlet</code>类中的<code>doGet()</code>和<code>doPost()</code>等方法。</li>
</ul>
</li>
<li>具体类<code>ConcreteClass</code>:<ul>
<li>实现父类中的一个或多个抽象操作，它们会成为父类中的顶级逻辑的组成部分。</li>
<li>每一个抽象类都可以有任意多个具体类与之对应，而每一个具体类都可以给出这些抽象方法（也就是顶级逻辑的组成步骤）的不同实现，从而使得顶级逻辑的实现各不相同。</li>
<li>具体类选择覆盖钩子方法，对算法的不同处进行挂钩。  </li>
</ul>
</li>
</ul>
<p>&emsp;&emsp;模板方法模式的核心思想是子类拥有可以置换掉父类顶级逻辑中的可变部分，但不可以改变模板方法中的顶级逻辑。</p>
<h2 id="模板方法模式案例"><a href="#模板方法模式案例" class="headerlink" title="模板方法模式案例"></a>模板方法模式案例</h2><p>&emsp;&emsp;考虑一个场景：有两种含有咖啡因的饮料，茶和咖啡，他们的冲泡流程都共有四步：  </p>
<ol>
<li>把水煮沸：boilWater()</li>
<li>用沸水冲泡：brew()</li>
<li>把冲泡好的饮料倒进杯子：pourInCup()</li>
<li>加调味品（这一步非必须）：addCondiments()</li>
</ol>
<p>对于两种饮料来说，1和3步骤是相同的，2和4步骤有一些略微的区别，于是可以将1和3设为抽象类中的具体方法，2和4作为抽象方法被子类所继承。同时在步骤4中，用户可能需要加调味品，也可能不要，这就需要在子类中去判定，因此要设置一个钩子方法<code>customerWantsCondiments()</code>，其默认返回true，即用户需要加调味品。这样一个场景的UML类图如下：  </p>
<p></p><p align="center"><br><img src="http://odnk9as2f.bkt.clouddn.com/CaffeinBeverageWithHook-2.png" width="600px" name="模板方法模式类图"><br></p><br>具体的实现代码如下，为简洁起见，这里只给出抽象类和<code>CoffeeWithHook</code>这个具体类的代码，<code>TeaWithHook</code>的代码与咖啡的代码类似。  <p></p>
<ul>
<li>抽象类：  </li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.edu.whu;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 带hook方法的抽象类CaffineBeverageWithHook</span></span><br><span class="line"><span class="comment"> * Created by wuwenan on 31/05/2017.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">CaffeineBeverageWithHook</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">prepareRecipe</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        boilWater();</span><br><span class="line">        brew();</span><br><span class="line">        pourInCup();</span><br><span class="line">        <span class="keyword">if</span> (customerWantsCondiments()) &#123;</span><br><span class="line">            addCondiments();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">brew</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">addCondiments</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">boilWater</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Boiling water"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">pourInCup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Pouring into cup"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">customerWantsCondiments</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>咖啡具体类：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.edu.whu;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 继承自CaffineBeverageWithHook</span></span><br><span class="line"><span class="comment"> * Created by wuwenan on 31/05/2017.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CoffeeWithHook</span> <span class="keyword">extends</span> <span class="title">CaffeineBeverageWithHook</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">brew</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Brewing the coffee"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">addCondiments</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Adding coffee condiments"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//重写父类中的hook方法</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">customerWantsCondiments</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        String answer = getUserInput();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (answer.toLowerCase().startsWith(<span class="string">"y"</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//接收用户输入并返回</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> String <span class="title">getUserInput</span><span class="params">()</span></span>&#123;</span><br><span class="line">        String answer = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">"咖啡要加调料吗？(y/n)"</span>);</span><br><span class="line"></span><br><span class="line">        BufferedReader in = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(System.in));</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            answer = in.readLine();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (answer == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"no"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> answer;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>测试类：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.edu.whu;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 测试类</span></span><br><span class="line"><span class="comment"> * Created by wuwenan on 31/05/2017.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BeverageTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        CoffeeWithHook coffeeHook = <span class="keyword">new</span> CoffeeWithHook();</span><br><span class="line">        System.out.println(<span class="string">"开始制作咖啡..."</span>);</span><br><span class="line">        coffeeHook.prepareRecipe();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;最后的输出结果为：  </p>
<pre><code class="java">开始制作咖啡...
Boiling water
Brewing the coffee
Pouring into cup
咖啡要加调料吗？(y/n)
y
Adding coffee condiments
</code></pre>
<p>PS：以上代码已上传至我的Github，地址是：<a href="https://github.com/Wanz2/DesignPatterns" target="_blank" rel="noopener">https://github.com/Wanz2/DesignPatterns</a></p>

	
	</div>
  <a type="button" href="/2017/05/31/设计模式——模板方法模式/#more" class="btn btn-default more">阅读此文</a>
</div>

	       
		     
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2017-05-31 </div>
			<div class="article-title"><a href="/2017/05/31/设计模式——策略模式/" title="策略模式（Strategy Pattern）是设计模式中常用的一个，也是非常强大的一个，本文对策略模式进行了介绍并通过案例对其进行分析。">设计模式——策略模式</a></div>						
		</h3>
	


		     <div class="entry">
  <div class="row">
	
	
		<p>&emsp;&emsp;策略模式（Strategy Pattern）是设计模式中常用的一个，也是非常强大的一个，本文对策略模式进行了介绍并通过案例对其进行分析。</p>
<h2 id="什么是策略模式"><a href="#什么是策略模式" class="headerlink" title="什么是策略模式"></a>什么是策略模式</h2><p>&emsp;&emsp;首先给出策略模式的概念：  </p>
<blockquote>
<p>策略模式定义了算法族，分别封装起来，让它们之间可以互相替换，此模式让算法的变化独立于使用算法的客户。  </p>
</blockquote>
<p>&emsp;&emsp;策略模式将对象本身和对象的行为分开，一个对象可能会拥有一组功能相似的算法，它使用“组合”将对象和算法结合，它的核心思想就是面向对象的多态思想。</p>
<h2 id="策略模式案例"><a href="#策略模式案例" class="headerlink" title="策略模式案例"></a>策略模式案例</h2><p>&emsp;&emsp;首先给出一个策略模式的例子，假设一个场景：模拟一组鸭子和它们的行为。鸭子的种类有很多，但不同种类鸭子有一些共同的行为，如：<strong>鸣叫（quack）</strong>和<strong>飞行（fly）</strong>等，假设不同种类的鸭子的<strong>鸣叫（quack）</strong>和<strong>飞行（fly）</strong>的实现方法不同，那么怎样才能将不同的鸭子与不同的行为进行整合呢？<br>&emsp;&emsp;本例的UML图如下：<br><img src="http://odnk9as2f.bkt.clouddn.com/Strategy.png" alt="模拟鸭子程序的类图"><br>&emsp;&emsp;首先定义一个鸭子的抽象类，其中定义了所有鸭子共同的方法，此外，还有两个引用类型变量<code>flyBehavior</code>和<code>quackBehavior</code>，分别引用鸭子的两个行为接口<code>FlyBehavior</code>和<code>QuackBehavior</code>的对象；然后定义两个行为族接口<code>FlyBehavior</code>和<code>QuackBehavior</code>，而不同的飞行方法和不同的鸣叫方法分别使用类继承上述的接口来实现，鸭子和鸭子的行为通过类之间的组合来实现。<br>&emsp;&emsp;以上的模式有几个值得注意的点：    </p>
<ol>
<li><strong>面向接口编程而不是针对具体的实现类编程。</strong>这里的“接口”不仅指接口，还可以指超类，这里利用了<strong>多态</strong>的思想。可以看到Duck类中的行为变量类型是接口类型<code>QuackBehavior</code>和<code>FlyBehavior</code>，而非其具体的实现类，这样做的话可以使得该对象运行时能够根据实际状况选择不同的行为，不会被绑死在超类行为上。面向接口编程具体的操作方式是：在声明变量时将其声明为接口类型，在为变量赋值时使用具体的实现类型。  </li>
<li><strong>使用“组合”而非“继承”。</strong>这里并没有将鸣叫和飞行作为Duck类的行为，而是将其分别当做一个类，然后通过Duck类和行为类的组合来对鸭子和鸭子的行为进行整合。使用“组合”建立系统有很大的弹性，不仅可以将算法族封装成不同的类，更可以在运行时动态改变行为，只要组合的行为对象符合正确的接口标准。  </li>
<li><strong>通过setter方法在运行时改变对象的行为。</strong>注意到Duck抽象类中有两个方法<code>setFlyBehafior(FlyBehavior fb)</code>和<code>setQuackBehavior(QuackBehavior qb)</code>，这两个方法可以在运行时设置变量<code>flyBehavior</code>和<code>quackBehavior</code>的值，通过注入不同的行为对象改变Duck类实例对象的行为。  <h2 id="案例代码"><a href="#案例代码" class="headerlink" title="案例代码"></a>案例代码</h2>&emsp;&emsp;下面来看一看上面例子的具体代码，为了说明方便，下面代码中不会给出<code>MallardDuck</code>，仅以<code>ModelDuck</code>类为例：  </li>
</ol>
<ul>
<li><code>Duck</code>抽象类：  </li>
</ul>
<pre><code class="java"><span class="keyword">package</span> cn.edu.whu;

<span class="comment">/**</span>
<span class="comment"> * Duck抽象类</span>
<span class="comment"> * Created by wuwenan on 30/05/2017.</span>
<span class="comment"> */</span>
<span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Duck</span> </span>{

    FlyBehavior flyBehavior;

    QuackBehavior quackbehavior;

    <span class="function"><span class="keyword">public</span> <span class="title">Duck</span><span class="params">()</span> </span>{
    }

    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">swim</span><span class="params">()</span> </span>{
        System.out.println(<span class="string">"All ducks can swim."</span>);
    }

    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">display</span><span class="params">()</span></span>;

    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">performFly</span><span class="params">()</span> </span>{
        flyBehavior.fly();
    }

    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">performQuack</span><span class="params">()</span> </span>{
        quackbehavior.quack();
    }

    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setFlyBehavior</span><span class="params">(FlyBehavior fb)</span> </span>{
        <span class="keyword">this</span>.flyBehavior = fb;
    }

    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setQuackbehavior</span><span class="params">(QuackBehavior qb)</span> </span>{
        <span class="keyword">this</span>.quackbehavior = qb;
    }
}

</code></pre>
<ul>
<li><code>ModelDuck</code>类：  </li>
</ul>
<pre><code class="java"><span class="keyword">package</span> cn.edu.whu;

<span class="comment">/**</span>
<span class="comment"> * ModelDuck类，继承自Duck抽象类</span>
<span class="comment"> * Created by wuwenan on 31/05/2017.</span>
<span class="comment"> */</span>
<span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ModelDuck</span> <span class="keyword">extends</span> <span class="title">Duck</span> </span>{

    <span class="meta">@Override</span>
    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">display</span><span class="params">()</span> </span>{
        System.out.println(<span class="string">"I am a model duck!"</span>);
    }

    <span class="function"><span class="keyword">public</span> <span class="title">ModelDuck</span><span class="params">()</span> </span>{
        flyBehavior = <span class="keyword">new</span> FlyNoWay();
        quackbehavior = <span class="keyword">new</span> Quack();
    }
}

</code></pre>
<ul>
<li><code>FlyBehavior</code>接口及其实现类：  </li>
</ul>
<pre><code class="java"><span class="keyword">package</span> cn.edu.whu;

<span class="comment">/**</span>
<span class="comment"> * FlyBehavior接口</span>
<span class="comment"> * Created by wuwenan on 31/05/2017.</span>
<span class="comment"> */</span>
<span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">FlyBehavior</span> </span>{
    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fly</span><span class="params">()</span></span>;
}

<span class="keyword">package</span> cn.edu.whu;

<span class="comment">/**</span>
<span class="comment"> * FlyNoWay类，继承自FlyBehavior接口</span>
<span class="comment"> * Created by wuwenan on 31/05/2017.</span>
<span class="comment"> */</span>
<span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FlyNoWay</span> <span class="keyword">implements</span> <span class="title">FlyBehavior</span> </span>{

    <span class="meta">@Override</span>
    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fly</span><span class="params">()</span> </span>{
        System.out.println(<span class="string">"I can't Fly! "</span>);
    }
}

<span class="keyword">package</span> cn.edu.whu;

<span class="comment">/**</span>
<span class="comment"> * FlyWithWings类，继承自FlyBehavior接口</span>
<span class="comment"> * Created by wuwenan on 31/05/2017.</span>
<span class="comment"> */</span>
<span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FlyWithWings</span> <span class="keyword">implements</span> <span class="title">FlyBehavior</span> </span>{

    <span class="meta">@Override</span>
    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fly</span><span class="params">()</span> </span>{
        System.out.println(<span class="string">"I'm flying!"</span>);
    }
}

<span class="keyword">package</span> cn.edu.whu;

<span class="comment">/**</span>
<span class="comment"> * FlyRocketPowered类，继承自FlyBehavior接口</span>
<span class="comment"> * Created by wuwenan on 31/05/2017.</span>
<span class="comment"> */</span>
<span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FlyRocketPowered</span> <span class="keyword">implements</span> <span class="title">FlyBehavior</span> </span>{
    <span class="meta">@Override</span>
    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fly</span><span class="params">()</span> </span>{
        System.out.println(<span class="string">"I'm flying with a rocket!"</span>);
    }
}

</code></pre>
<ul>
<li>QuackBehavior接口及其实现类：</li>
</ul>
<pre><code class="java"><span class="keyword">package</span> cn.edu.whu;

<span class="comment">/**</span>
<span class="comment"> * QuackBehavior接口</span>
<span class="comment"> * Created by wuwenan on 31/05/2017.</span>
<span class="comment"> */</span>
<span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">QuackBehavior</span> </span>{
    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">quack</span><span class="params">()</span></span>;
}

<span class="keyword">package</span> cn.edu.whu;

<span class="comment">/**</span>
<span class="comment"> * Quack类，继承自QuackBehavior接口</span>
<span class="comment"> * Created by wuwenan on 31/05/2017.</span>
<span class="comment"> */</span>
<span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Quack</span> <span class="keyword">implements</span> <span class="title">QuackBehavior</span> </span>{

    <span class="meta">@Override</span>
    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">quack</span><span class="params">()</span> </span>{
        System.out.println(<span class="string">"Quack"</span>);
    }
}

<span class="keyword">package</span> cn.edu.whu;

<span class="comment">/**</span>
<span class="comment"> * Squeak类，继承自QuackBehavior接口</span>
<span class="comment"> * Created by wuwenan on 31/05/2017.</span>
<span class="comment"> */</span>
<span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Squeak</span> <span class="keyword">implements</span> <span class="title">QuackBehavior</span> </span>{

    <span class="meta">@Override</span>
    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">quack</span><span class="params">()</span> </span>{
        System.out.println(<span class="string">"Squeak"</span>);
    }
}

<span class="keyword">package</span> cn.edu.whu;

<span class="comment">/**</span>
<span class="comment"> * MuteQuack类，继承自QuackBehavior接口</span>
<span class="comment"> * Created by wuwenan on 31/05/2017.</span>
<span class="comment"> */</span>
<span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MuteQuack</span> <span class="keyword">implements</span> <span class="title">QuackBehavior</span> </span>{

    <span class="meta">@Override</span>
    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">quack</span><span class="params">()</span> </span>{
        System.out.println(<span class="string">"&lt;&lt; Silence &gt;&gt;"</span>);
    }
}

</code></pre>
<ul>
<li>测试类：  </li>
</ul>
<pre><code class="java"><span class="keyword">package</span> cn.edu.whu.test;

<span class="keyword">import</span> cn.edu.whu.Duck;
<span class="keyword">import</span> cn.edu.whu.FlyRocketPowered;
<span class="keyword">import</span> cn.edu.whu.ModelDuck;
<span class="keyword">import</span> cn.edu.whu.Squeak;

<span class="comment">/**</span>
<span class="comment"> * Duck测试类</span>
<span class="comment"> * Created by wuwenan on 31/05/2017.</span>
<span class="comment"> */</span>
<span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DuckTest</span> </span>{
    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{
        Duck duck = <span class="keyword">new</span> ModelDuck();
        duck.display();
        System.out.println(<span class="string">"-----鸭子开始行动-----"</span>);
        duck.performFly();
        duck.performQuack();
        System.out.println(<span class="string">"-----运行时改变鸭子的行为-----"</span>);
        duck.setFlyBehavior(<span class="keyword">new</span> FlyRocketPowered());
        duck.performFly();
        duck.setQuackbehavior(<span class="keyword">new</span> Squeak());
        duck.performQuack();
    }
}
</code></pre>
<p>&emsp;&emsp;最后输出的结果为：  </p>
<pre><code class="java">I am a model duck!  
-----鸭子开始行动-----  
I can<span class="string">'t Fly!   </span>
<span class="string">Quack  </span>
<span class="string">-----运行时改变鸭子的行为-----  </span>
<span class="string">I'</span>m flying with a rocket!  
Squeak  
</code></pre>
<h2 id="策略模式的优缺点"><a href="#策略模式的优缺点" class="headerlink" title="策略模式的优缺点"></a>策略模式的优缺点</h2><h3 id="优点："><a href="#优点：" class="headerlink" title="优点："></a>优点：</h3><ol>
<li>封装了相关算法。如果将上面的每一个鸭子行为看做是一个算法，那么策略模式能够封装一组功能相似的算法形成一个个<strong>策略类</strong>，有助于抽取出这些算法的公共部分放在上层接口中，也使得客户可以根据不同要求从不同算法中进行选择使用。  </li>
<li>使用组合替换继承关系。设计的原则之一就是多使用组合而少使用继承。上例中若使用继承，则是令<code>ModelDuck</code>继承<code>Duck</code>然后在<code>ModelDuck</code>中重写鸭子的行为，但这样就将算法的实现写死在了子类中，从而使<code>ModelDuck</code>难以理解，难以维护，难以扩展，且不能够动态改变，而使用组合则避免了这些问题。 </li>
</ol>
<h3 id="缺点："><a href="#缺点：" class="headerlink" title="缺点："></a>缺点：</h3><ol>
<li>客户端必须要知道所有策略类。客户必须知道所有策略类，才可能了解每个算法有什么不同以便进行选择，因此需要向客户暴露所有策略类的实现。  </li>
<li>策略类和主体类之间有通信开销。上例中，无论各个鸭子行为实现的算法是简单还是复杂, 它们都共享<code>FlyBehavior</code>和<code>QuackBehavior</code>定义的接口。因此很可能某些具体行为不会都用到所有通过这个接口传递给它们的信息；一些简单的算法可能不使用其中的任何信息！这就意味着有时主体类会创建和初始化一些永远不会用到的参数。如果存在这样问题，那么将需要在策略类和主体类之间更进行紧密的耦合。  </li>
<li>策略模式将产生很多策略类。可以通过使用<strong>享元模式</strong>在一定程度上减少对象的数量。  </li>
</ol>
<h2 id="什么情况下适用策略模式"><a href="#什么情况下适用策略模式" class="headerlink" title="什么情况下适用策略模式"></a>什么情况下适用策略模式</h2><p>&emsp;&emsp;在以下情形下策略模式较为适用：  </p>
<ol>
<li>许多相关的类仅仅是行为有异。“策略”提供了一种用多个行为中的一个行为来配置一个类的方法。即一个系统需要动态地在几种算法中选择一种。</li>
<li>需要使用一个算法的不同变体。例如，你可能会定义一些反映不同的空间/时间权衡的算法。当这些变体实现为一个算法的类层次时，可以使用策略模式。</li>
<li>算法使用客户不应该知道的数据。可使用策略模式以避免暴露复杂的、与算法相关的数据结构。</li>
<li>一个类定义了多种行为，并且这些行为在这个类的操作中以多个条件语句的形式出现。将相关的条件分支移入它们各自的策略类中以代替这些条件语句。    </li>
</ol>
<p>PS：  </p>
<ol>
<li>本文<code>策略模式的优缺点</code>和<code>什么情况下适用策略模式</code>两个部分参考博客 <a href="http://blog.csdn.net/hguisu/article/details/7558249" target="_blank" rel="noopener">设计模式 ( 十八 ) 策略模式Strategy（对象行为型）</a>，感谢作者。</li>
<li>以上代码已上传至我的Github，地址是：<a href="https://github.com/Wanz2/DesignPatterns" target="_blank" rel="noopener">https://github.com/Wanz2/DesignPatterns</a></li>
</ol>

	
	</div>
  <a type="button" href="/2017/05/31/设计模式——策略模式/#more" class="btn btn-default more">阅读此文</a>
</div>

	       
	     </div>
	     <div>
	       <center>
	         <div class="pagination">
<ul class="pagination">
	 
</ul>
</div>

	       </center>
	     </div>	
      

</div> <!-- col-md-9/col-md-12 -->


<div class="col-md-3">
	<div id="sidebar">
	
			
  <div id="site_search">
   <div class="form-group">
    <input type="text" id="local-search-input" name="q" results="0" placeholder="搜索" class="st-search-input st-default-search-input form-control"/>
   </div>  
  <div id="local-search-result"></div>
  </div>


		
			<div class="widget">
    
	    <h4 class="dsq-widget-title">最新留言</h4>
		<div id="recent-comments"></div>
		<script type="text/javascript">
		    getRecentCommentsList({
			   type: "github" ? "github" : "github",
			   user: "wzpan",
               repo: "hexo-theme-freemind-blog",
               client_id: "bf7d4ba11877db88543e",
               client_secret: "bff8a6b06b745c0bfcdccbe225623ea8e2a057bb",
			   count: "5" ? "5" : 5,
			   recent_comments_target: "#recent-comments"
			});
		</script>
	
</div>

		
			
	<div class="widget">
		<h4>分类</h4>
		<ul class="tag_box inline list-unstyled">
		
			<li><a href="/categories/Python/Docker/">Docker<span>1</span></a></li>
		
			<li><a href="/categories/Java/">Java<span>9</span></a></li>
		
			<li><a href="/categories/Linux/">Linux<span>1</span></a></li>
		
			<li><a href="/categories/Python/">Python<span>1</span></a></li>
		
			<li><a href="/categories/Web开发/">Web开发<span>1</span></a></li>
		
			<li><a href="/categories/图像处理/">图像处理<span>1</span></a></li>
		
			<li><a href="/categories/数据库/">数据库<span>1</span></a></li>
		
			<li><a href="/categories/数据结构与算法/">数据结构与算法<span>1</span></a></li>
		
			<li><a href="/categories/机器学习/">机器学习<span>6</span></a></li>
		
			<li><a href="/categories/系统架构/">系统架构<span>1</span></a></li>
		
			<li><a href="/categories/经验心得/">经验心得<span>3</span></a></li>
		
			<li><a href="/categories/设计模式/">设计模式<span>4</span></a></li>
		
		</ul>
	</div>

		
			
	<div class="widget">
		<h4>标签云</h4>
		<ul class="tag_box inline list-unstyled">		
		
			<li><a href="/tags/Java/">Java<span>11</span></a></li>
		
			<li><a href="/tags/经验心得/">经验心得<span>4</span></a></li>
		
			<li><a href="/tags/Python/">Python<span>1</span></a></li>
		
			<li><a href="/tags/Linux/">Linux<span>1</span></a></li>
		
			<li><a href="/tags/设计模式/">设计模式<span>4</span></a></li>
		
			<li><a href="/tags/框架/">框架<span>1</span></a></li>
		
			<li><a href="/tags/Web开发/">Web开发<span>1</span></a></li>
		
			<li><a href="/tags/Java虚拟机/">Java虚拟机<span>1</span></a></li>
		
			<li><a href="/tags/图像处理/">图像处理<span>1</span></a></li>
		
			<li><a href="/tags/数据结构与算法/">数据结构与算法<span>1</span></a></li>
		
			<li><a href="/tags/机器学习/">机器学习<span>6</span></a></li>
		
			<li><a href="/tags/数据库/">数据库<span>1</span></a></li>
		
			<li><a href="/tags/Docker/">Docker<span>1</span></a></li>
		
			<li><a href="/tags/系统架构/">系统架构<span>1</span></a></li>
		
			<li><a href="/tags/泛型/">泛型<span>1</span></a></li>
		
		 
		</ul>
	</div>


		
			
<div class="widget">
  <h4>最新文章</h4>
  <ul class="entry list-unstyled">
    
      <li>
        <a href="/2020/06/08/《高效能人士的七个习惯》读书笔记/"  title="《高效能人士的七个习惯》读书笔记" ><i class="fa fa-file-o"></i>《高效能人士的七个习惯》读书笔记</a>
      </li>
    
      <li>
        <a href="/2020/04/20/数据库性能优化分析/"  title="最近负责考虑自己所在项目的数据库性能优化方案，主要是一张大表 **table_a**，预计上线以后会有亿级甚至十亿级数据，需要解决单表数据量过大所带来的性能和管理问题。本文对常用数据库优化方法进行整理、分析和总结，最终给出了适合本项目的数据库优化方案。" ><i class="fa fa-file-o"></i>数据库性能优化方法专题分析</a>
      </li>
    
      <li>
        <a href="/2018/09/13/win10上PyCharm选择本地docker镜像中解释器报NullPointerException解决方案/"  title="在win10中使用PyCharm进行Python开发，通过Docker搭建本地开发环境会比较方便。我在这个过程中遇到了一个纠结了很久的问题，docker-machine启动后，在PyCharm中选择项目解释器时会报异常，同时PyCharm中会显示docker-machine没有运行。" ><i class="fa fa-file-o"></i>win10上PyCharm选择本地docker镜像中解...</a>
      </li>
    
      <li>
        <a href="/2018/06/01/磁盘分区与Ext2文件系统/"  title="磁盘分区与Linux的Ext2文件系统简介。" ><i class="fa fa-file-o"></i>磁盘分区与Ext2文件系统</a>
      </li>
    
      <li>
        <a href="/2017/09/04/FreeMarker模板引擎实战/"  title="FreeMarker是一个模板引擎：它是一个Java库，基于模板和要改变的数据生成输出文本（HTML网页、电子邮件、配置文件、源代码等）。本文通过一个小demo来说明FreeMarker的使用方式。" ><i class="fa fa-file-o"></i>FreeMarker模板引擎实战</a>
      </li>
    
  </ul>
</div>

		
			
<div class="widget">
	<h4>链接</h4>
	<ul class="blogroll list-unstyled">
	
		<li><i class="fa fa-github"></i><a href="https://github.com/wzpan/freemind/" title="Freemind's Github repository." target="_blank"]);">Freemind</a></li>
	
		<li><i class="fa fa-github"></i><a href="http://www.github.com/wzpan" title="My Github account." target="_blank"]);">My Github</a></li>
	
		<li><i class="fa fa-linkedin"></i><a href="http://www.linkedin.com/in/hahack" title="My Linkin account." target="_blank"]);">My LinkedIn</a></li>
	
	</ul>
</div>


		
	</div> <!-- sidebar -->
</div> <!-- col-md-3 -->




    </div>
  </div>
  <div class="container-narrow">
    <footer> <p>
  &copy; 2020 Aaron Wu
  
      with help from <a href="http://hexo.io/" target="_blank">Hexo</a> and <a href="http://getbootstrap.com/" target="_blank">Twitter Bootstrap</a>. Theme by <a href="http://github.com/wzpan/hexo-theme-freemind/">Freemind</a>.    
</p> </footer>
  </div> <!-- container-narrow -->
  


  
<a id="gotop" href="#">   
  <span>▲</span> 
</a>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
<script src="/js/search.js"></script> 


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>




<!-- syntax highlighting -->

  <script>
  marked.setOptions({
    highlight: function (code, lang) {
        return hljs.highlightAuto(code).value;
    }
  });
  function Highlighting(){
    var markdowns = document.getElementsByClassName('markdown');
    for(var i=0;i<markdowns.length;i++){
        if(markdowns[i].innerHTML) markdowns[i].innerHTML =marked(markdowns[i].innerHTML);
    }
  }
  window.addEventListener('DOMContentLoaded', Highlighting, false);
  window.addEventListener('load', Highlighting, false);
  </script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->


</body>
</html>