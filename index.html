<!DOCTYPE HTML>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
  
  <title>Aaron Wu</title>
  <meta name="author" content="Aaron Wu">
  
  <meta name="description" content="Aaron Wu">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
  <meta property="og:site_name" content="Aaron Wu">

  
    <meta property="og:image" content="undefined">
  

  
  
    <link href="/favicon.png" rel="icon">
  

  <!-- CSS -->
  <link rel="stylesheet" href="/css/themes/cerulean.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/responsive.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight-default.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/comment.css" media="screen" type="text/css">
  <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.9/es5-shim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.7/es5-sham.min.js"></script>
  <![endif]-->

  <script src="/js/jquery-2.0.3.min.js"></script>
  
    <script src="/js/marked.js"></script>
    <script src="/js/comment.js"></script>
    <script src="/js/timeago.min.js"></script>
    <script src="/js/highlight.min.js"></script>
	<script src="/js/spin.min.js"></script>
  
  <!-- analytics --><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  



</head>

<body>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><nav id="main-nav" class="navbar navbar-inverse navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
      <button type="button" class="navbar-header navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
	<span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
       <a class="navbar-brand" href="/">Aaron Wu</a>
      <div class="collapse navbar-collapse nav-menu">
		<ul class="nav navbar-nav">
		  
		  <li>
			<a href="/archives" title="All the articles.">
			  <i class="fa fa-archive"></i>Archives
			</a>
		  </li>
		  
		  <li>
			<a href="/categories" title="All the categories.">
			  <i class="fa fa-folder"></i>Categories
			</a>
		  </li>
		  
		  <li>
			<a href="/tags" title="All the tags.">
			  <i class="fa fa-tags"></i>Tags
			</a>
		  </li>
		  
		  <li>
			<a href="/about" title="About me.">
			  <i class="fa fa-user"></i>About
			</a>
		  </li>
		  
		</ul>
      </div>
    </div> <!-- container -->
</nav>
<div class="clearfix"></div>

  <div class="container">
    <div class="content">
      <div class="page-header page-header-inverse ">
  <h1 class="title title-inverse ">Strive for excellence, not perfection.</h1>
</div>

<div class="row page">

	
	<div class="col-md-9">
	

		<div class="slogan">
      <i class="fa fa-heart"></i>
      Yet another bootstrap theme.
</div>    
		<div id="top_search"></div>
		<div class="mypage">
		
		<!-- title and entry -->
        <!-- render top articles firstly -->
        
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
        
        <!-- render other articles -->
        
           
			  
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2020-06-08 </div>
			<div class="article-title"><a href="/2020/06/08/《高效能人士的七个习惯》读书笔记/" title="《高效能人士的七个习惯》读书笔记">《高效能人士的七个习惯》读书笔记</a></div>						
		</h3>
	


			  <div class="entry">
  <div class="row">
	
	
		<p>最近部门组织大家学习《高效能人士的七个习惯》。本书讲述了在人类成长的过程中，有关个人成功的三个习惯：积极主动、以终为始、要事第一，以及追求公众成功的三个习惯：双赢思维、知彼解己、统合综效，以及加强前面六个习惯的第七个习惯——不断更新。七个习惯可以视为个人成长由依赖走向独立乃至互赖的普遍方法论，但作者并不是开篇直接切入介绍这七个习惯，而是用第一章和第二章来论述了这七个习惯的重要意义以及学习这七个习惯前的思想准备，逻辑推导严谨而有趣，本文想整理一下作者的思维逻辑，以加深自己的理解。</p>
<h6 id="一、思维方式的重要性"><a href="#一、思维方式的重要性" class="headerlink" title="一、思维方式的重要性"></a>一、思维方式的重要性</h6><p>书中介绍的七个习惯，并不是处理具体问题的方法，而是我们生活工作中需要遵循的思想上的原则，是一种思维方式。但如果你不认可思维方式的重要性，那么你大概也不会意识到培养这样的思维方式的必要性。作者举了不少例子，说明了外界的条件作用会对人类的认知和思维方式产生强大的影响，而思维方式是行为与态度的源头，它会指导人的行为方式。倘若我们只改变表面的行为，而不改变真正的思维方式，那就是表里不一、言不由衷。而由于思维方式易受外界影响，因此我们必须对它负责，不断审视它，在现实中检验它，从而让自己能够更加客观地去看待外部世界，并做出正确的选择。</p>
<h6 id="二、培养以原则为中心的思维方式"><a href="#二、培养以原则为中心的思维方式" class="headerlink" title="二、培养以原则为中心的思维方式"></a>二、培养以原则为中心的思维方式</h6><p>当我们认识到思维方式的重要性之后，我们就需要明白培养思维方式的正确方向： 使其符合原则。这就是以原则为中心的思维方式。原则如灯塔，是不容动摇的自然法则，一个人的思维方式越符合原则或自然法则，就越能正确而高效地生活。七个习惯想强调的并不是机械地遵循一些方法去生活，而是要理解这些方法背后的原则，而这些原则是放之四海皆准的真理。这和唯物主义辩证法的思想是一致的，要求我们坚持真理，实事求是。</p>
<h6 id="三、什么是效能"><a href="#三、什么是效能" class="headerlink" title="三、什么是效能"></a>三、什么是效能</h6><p>我们建立起以原则为中心的思维方式之后，我们可以开始学习七个习惯所依赖的原则基础：“产出/产能平衡”（P/PC Balance），可以用公司内常讲到的我们要“多打粮食，增加土地肥力”来理解。“粮食”就是产出，“土地肥力”就是产能。“产出”是我们收获的成果，“产能”是我们用以生产的资产或能力。“效能”即在于产出/产能平衡的平衡。这一原则蕴藏在工作、生活、个人发展、企业发展的方方面面。倘若我们只重视产出，忽略产能，我们便是竭泽而渔，失去了可持续发展的能力；倘若我们只重视产能，忽视产出，便迟迟没有收获，也会失去提升产能的能力和动力。</p>
<p>我们以“产出/产能平衡”的原则为逻辑起点，去思考怎样提升效能水平，便能更好地去理解七个习惯，前三个习惯将帮助我们提升个人的效能，第四到第七个习惯有助于提升团队的效能，第七个习惯有助于我们不断提升其他六个习惯的实施效率。作者由浅入深，逻辑清晰，令人信服。</p>

	
	</div>
  <a type="button" href="/2020/06/08/《高效能人士的七个习惯》读书笔记/#more" class="btn btn-default more">阅读此文</a>
</div>

           
		
           
			  
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2020-04-20 </div>
			<div class="article-title"><a href="/2020/04/20/数据库性能优化分析/" title="最近负责考虑自己所在项目的数据库性能优化方案，主要是一张大表 **table_a**，预计上线以后会有亿级甚至十亿级数据，需要解决单表数据量过大所带来的性能和管理问题。本文对常用数据库优化方法进行整理、分析和总结，最终给出了适合本项目的数据库优化方案。">数据库性能优化方法专题分析</a></div>						
		</h3>
	


			  <div class="entry">
  <div class="row">
	
	
		<p>背景：最近负责考虑自己所在项目的数据库性能优化方案，主要是一张大表 <strong>table_a</strong>，预计上线以后会有亿级甚至十亿级数据，需要解决单表数据量过大所带来的性能和管理问题。</p>
<p>​    本文对常用数据库优化方法进行整理、分析和总结，最终给出了适合本项目的数据库优化方案。若要跳过各数据库优化方法的分析，直接看优化方案，<strong>可直接跳到第3节</strong>。</p>
<h2 id="1-数据库常用优化方法分析"><a href="#1-数据库常用优化方法分析" class="headerlink" title="1. 数据库常用优化方法分析"></a>1. 数据库常用优化方法分析</h2><p>​    首先，介绍一下较为常用的数据库优化方案，并进行适用场景、优势劣势分析。</p>
<h3 id="1-1-数据删除策略"><a href="#1-1-数据删除策略" class="headerlink" title="1.1 数据删除策略"></a>1.1 数据删除策略</h3><h4 id="1-1-1-理论依据"><a href="#1-1-1-理论依据" class="headerlink" title="1.1.1 理论依据"></a>1.1.1 理论依据</h4><p>​    参考原则：任何表的设计都要考虑到数据的删除策略，表中的数据不能无止境的增长而不删除。</p>
<h3 id="1-2-优化SQL设计"><a href="#1-2-优化SQL设计" class="headerlink" title="1.2 优化SQL设计"></a>1.2 优化SQL设计</h3><p>​    包括SQL语句优化、游标、存储过程等</p>
<h3 id="1-3-优化数据库对象设计"><a href="#1-3-优化数据库对象设计" class="headerlink" title="1.3 优化数据库对象设计"></a>1.3 优化数据库对象设计</h3><p>​    包括表、索引、分区设计等</p>
<h3 id="1-4-缓存策略"><a href="#1-4-缓存策略" class="headerlink" title="1.4 缓存策略"></a>1.4 缓存策略</h3><h4 id="1-4-1-理论依据"><a href="#1-4-1-理论依据" class="headerlink" title="1.4.1 理论依据"></a>1.4.1 理论依据</h4><p>​    缓存策略：对于高并发需要访问数据库的业务操作，可以考虑在业务和数据库之间增设高速缓存组件xxx，从而提高业务性能。</p>
<h4 id="1-4-2-适用性分析"><a href="#1-4-2-适用性分析" class="headerlink" title="1.4.2 适用性分析"></a>1.4.2 适用性分析</h4><p>​    项目中引入缓存一般是为了应对高频访问且不常修改的数据的查询，防止大量的请求进入数据库，导致其他数据操作的延迟。</p>
<h3 id="1-5-读写分离"><a href="#1-5-读写分离" class="headerlink" title="1.5 读写分离"></a>1.5 读写分离</h3><h4 id="1-5-1-理论依据"><a href="#1-5-1-理论依据" class="headerlink" title="1.5.1 理论依据"></a>1.5.1 理论依据</h4><p>​    读写分离策略：</p>
<p>1）对于读多、写少访问特别频繁的表，可以考虑采取读写分离的架构，通过增加读库来提高业务读操作的能力。</p>
<p>2）如果业务需要构建读写分离能力，统一使用分布式数据库中间件这个标准方案</p>
<h4 id="1-5-2-适用性分析"><a href="#1-5-2-适用性分析" class="headerlink" title="1.5.2 适用性分析"></a>1.5.2 适用性分析</h4><ul>
<li>读写分离原理： 将数据库分为主从库，一个主库用于写数据，多个从库完成读数据的操作，主从库之间通过某种机制进行数据的同步，是一种常见的数据库架构。</li>
</ul>
<ul>
<li>读写分离解决的问题：在读多写少的场景下，数据库的读会首先称为数据库的瓶颈。这时，如果我们希望能够线性的提升数据库的读性能，消除读写锁冲突从而提升数据库的写性能，那么就可以使用读写分离架构。读写分离分散了数据库读写的压力，但没有分散存储压力。</li>
</ul>
<ul>
<li>对时效性没有那么高的场景下，才可以使用读写分离，如：需要生成运营报表，可以用读写分离。对于业务相关的数据库操作，时效性要求比较高，都不要做读写分离</li>
</ul>
<h3 id="1-6-数据库水平切分：分区、水平库内分表、水平分库分表"><a href="#1-6-数据库水平切分：分区、水平库内分表、水平分库分表" class="headerlink" title="1.6 数据库水平切分：分区、水平库内分表、水平分库分表"></a>1.6 数据库水平切分：分区、水平库内分表、水平分库分表</h3><p>​    数据库水平切分，可以分为分区、分库、分表，本节对这几种方式分别进行简要分析。</p>
<h4 id="1-6-1-理论依据："><a href="#1-6-1-理论依据：" class="headerlink" title="1.6.1 理论依据："></a>1.6.1 理论依据：</h4><p>​    分表分库策略</p>
<p>1）对于记录数超过2000w的大表，需要考虑物理分库、分表或者创建分区表，分区记录同样不超过2000w</p>
<p>2）业务数据量超过1亿，数据库文件&gt;500G，并且随着时间的推移会持续增长，建议考虑使用分库分表的解决方案，使用分布式数据库中间件xxxx来实现。</p>
<h4 id="1-6-2-分区"><a href="#1-6-2-分区" class="headerlink" title="1.6.2 分区"></a>1.6.2 分区</h4><h5 id="1-6-2-1-理论依据"><a href="#1-6-2-1-理论依据" class="headerlink" title="1.6.2.1 理论依据"></a>1.6.2.1 理论依据</h5><p>​    对于超过1000万行的大表，要考虑建分区</p>
<p>​    分区的目的</p>
<p>1) 易于管理：随着数据量的递增，表和索引越来越难维护，增删改查的速度也会越来越慢，使用分区将表和索引分割成较小的单元，便于维护与管理。使用分区能够聚焦于特别的分区，比如按月分区表，只需要逻辑备份当前月的数据，因此可以使用partiton指定到本月而不用全表备份。在清理历史数据的时候，只需要针对历史分区采用truncate操作，极大的降低了管理的难度。</p>
<p>2) 提高性能：由于每个分区的数据量大大减少，因此在增删改查的时候，可以通过指定分区范围来提高检索的性能。在进行并行操作的时候，采用智能分区连接减少上下文的切换也可以极大的提高性能。</p>
<p>3) 提高可用性：某个分区出现问题不会影响正常分区的使用；通过指定不同的tablespace作物理分割，不但可以提高查询的性能，还能够避免热块竞争。</p>
<h5 id="1-6-2-2-适用性分析"><a href="#1-6-2-2-适用性分析" class="headerlink" title="1.6.2.2 适用性分析"></a>1.6.2.2 适用性分析</h5><p>​    分析：使用分区，需要考虑分区键约束。MySQL官方给出的分区键的约束条件如下：</p>
<p>​     <strong>分区表达式中的所有列都必须是每个唯一键（包括主键）的一部分。</strong></p>
<p>换句话说：<strong>表中的每一个唯一键（包括主键），都必须包含分区表达式中的所有列。</strong></p>
<p><img src="mysql screen shot.png" alt="MySql 官网分区约束截图">                               </p>
<p>具体说明见MySQL官方文档：<a href="https://dev.mysql.com/doc/refman/5.6/en/partitioning-limitations-partitioning-keys-unique-keys.html" target="_blank" rel="noopener">https://dev.mysql.com/doc/refman/5.6/en/partitioning-limitations-partitioning-keys-unique-keys.html</a></p>
<p>依据上述约束条件，若要使用分区，需要考虑以下几点：</p>
<ul>
<li>表table_a必须存在主键</li>
</ul>
<ul>
<li>若要使用table_a的非主键字段进行分区，则要将其加入该表的主键和唯一索引字段，使得主键成为复合主键，唯一索引成为联合唯一索引。但一旦将其加入主键，使主键成为复合主键，则不满足第二范式：每一个非主键字段必须完全依赖于主键。</li>
</ul>
<p>对分区键约束条件的理解： 若不遵循该约束条件，则mysql无法在各分区之间保证由主键索引和唯一索引要求的记录唯一性。</p>
<h5 id="1-6-2-3-优劣分析"><a href="#1-6-2-3-优劣分析" class="headerlink" title="1.6.2.3 优劣分析"></a>1.6.2.3 优劣分析</h5><ul>
<li>优势：<ul>
<li>对代码侵入小</li>
<li>若使用用户id字段分区，能够将记录按用户均匀分配到不同分区中，能提高查询性能</li>
<li>若使用时间字段分区，有利于记录按时间段删除，避免delete语句带来的空间不释放问题（但如果使用了分库分表而不使用分区，磁盘空间碎片影响不大）</li>
</ul>
</li>
<li>劣势：<ul>
<li>使用分区需要调整主键和唯一索引，要将分区键加入主键和唯一索引。</li>
<li>如果使用用户id字段进行hash分区，扩展性较差</li>
<li>如果使用时间字段分区，单分区内数据量较大，未解决单表数据量过大的问题</li>
<li>分区表，如果需要调整表结构，如加字段，会比较慢</li>
<li>关联查询的逻辑需要调整</li>
</ul>
</li>
</ul>
<h4 id="1-6-3-水平库内分表"><a href="#1-6-3-水平库内分表" class="headerlink" title="1.6.3 水平库内分表"></a>1.6.3 水平库内分表</h4><h5 id="1-6-3-1优劣分析"><a href="#1-6-3-1优劣分析" class="headerlink" title="1.6.3.1优劣分析"></a>1.6.3.1优劣分析</h5><ul>
<li>优势：<ul>
<li>解决了单表数据量过大的问题</li>
</ul>
</li>
<li>劣势：<ul>
<li>库内分表对应用业务逻辑侵入性较大</li>
<li>只解决了单一表数据量过大的问题，但没有将表分布到不同机器的库上，因此对于减轻MySQL数据库的读写压力来说，帮助不是很大，大家还是竞争同一个物理机的CPU、内存、网络IO</li>
</ul>
</li>
</ul>
<h4 id="1-6-4-水平分库分表"><a href="#1-6-4-水平分库分表" class="headerlink" title="1.6.4 水平分库分表"></a>1.6.4 水平分库分表</h4><h5 id="1-6-4-1-适用性分析"><a href="#1-6-4-1-适用性分析" class="headerlink" title="1.6.4.1 适用性分析"></a>1.6.4.1 适用性分析</h5><p>​    读写分离分散了数据库读写操作的压力，但没有分散存储的压力，当数据量达到千万甚至上亿条的时候，单台数据库服务器的存储能力会成为系统的瓶颈。单个数据库服务器存储的数据量不能太大，需要控制在一定的范围内。为了满足业务数据存储的需求，就需要将存储分散到多台数据库服务器上。</p>
<h5 id="1-6-4-2-优劣分析"><a href="#1-6-4-2-优劣分析" class="headerlink" title="1.6.4.2 优劣分析"></a>1.6.4.2 优劣分析</h5><p>​    水平分库分表策略的优劣分析如下：</p>
<ul>
<li>优势：<ul>
<li>同时解决单表数据量过大和单服务IO性能不足的问题</li>
<li>对业务代码侵入小</li>
<li>水平扩展性好，可以实现不停服平滑扩容，不需要和分区同时实施</li>
</ul>
</li>
<li>劣势：<ul>
<li>分库成本比较高，需要至少两套数据库服务器，目前云服务要求一套DB至少有4台机器（主备）</li>
<li>分库可能带来以下问题：</li>
<li>事务一致性问题</li>
<li>跨节点关联查询 join 问题，关联查询逻辑需要调整</li>
<li>跨节点分页、排序、函数问题</li>
<li>全局主键避重问题</li>
<li>数据迁移、扩容问题</li>
</ul>
</li>
</ul>
<h2 id="2-数据库优化相关工具"><a href="#2-数据库优化相关工具" class="headerlink" title="2 数据库优化相关工具"></a>2 数据库优化相关工具</h2><p>​    业界常用开源数据库优化的工具有：</p>
<p><img src="db middleware.png" alt="业界常用开源数据库优化工具"></p>
<h2 id="3-优惠券服务数据库性能优化方案"><a href="#3-优惠券服务数据库性能优化方案" class="headerlink" title="3 优惠券服务数据库性能优化方案"></a>3 优惠券服务数据库性能优化方案</h2><p>​    经过上述分析，结合当前服务特点，对于本服务的数据库性能优化，建议按以下方法进行：</p>
<p>a)    优化SQL设计</p>
<p>b)    优化索引设计</p>
<p>c)    使用数据删除策略</p>
<p>d)    使用分布式缓存</p>
<p>e)    实施水平分库分表</p>
<p>注意，本服务数据库性能优化方案，不建议使用分区，具体原因见本文<a href="#_1.6.2.2_适用性分析">1.6.2.2节的适用性分析</a>和<a href="#_1.6.2.3_优劣分析">1.6.2.3的优劣分析</a>。</p>
<p>下面介绍上述各步骤的具体实施方案。</p>
<h3 id="3-1-优化SQL设计（开发时优化）"><a href="#3-1-优化SQL设计（开发时优化）" class="headerlink" title="3.1 优化SQL设计（开发时优化）"></a>3.1 优化SQL设计（开发时优化）</h3><p>开发人员在编写SQL语句时，按规范要求优化SQL设计。</p>
<h3 id="3-2-优化索引设计（开发时优化）"><a href="#3-2-优化索引设计（开发时优化）" class="headerlink" title="3.2 优化索引设计（开发时优化）"></a>3.2 优化索引设计（开发时优化）</h3><p>开发人员设计表索引时，按规范要求优化索引设计。</p>
<h3 id="3-3-数据删除策略"><a href="#3-3-数据删除策略" class="headerlink" title="3.3 数据删除策略"></a>3.3 数据删除策略</h3><p>使用定时任务，定期按照时间字段删除过期优惠券，避免table_a表中记录无限增长。</p>
<h3 id="3-4-使用分布式缓存"><a href="#3-4-使用分布式缓存" class="headerlink" title="3.4 使用分布式缓存"></a>3.4 使用分布式缓存</h3><p>识别热点数据和常用查询条件。</p>
<ul>
<li>热点数据从缓存查询，若缓存中数据不存在，则从DB中查询；</li>
</ul>
<ul>
<li>非热点数据直接查DB。</li>
</ul>
<p>更新热点数据时，先更新DB，再令缓存中数据失效。</p>
<h3 id="3-5-实施水平分库分表"><a href="#3-5-实施水平分库分表" class="headerlink" title="3.5 实施水平分库分表"></a>3.5 实施水平分库分表</h3><p>​    考虑数据量增长后的数据库扩展性，对于优惠券数据库，可以使用数据库中间件将数据量大的表实施水平分库分表。如对table_a表来说，可以使用用户id字段作为键来实施水平分库分表。</p>
<p>​    注意不要过早实施分库分表，避免”过度设计”和”过早优化”，但要尽早考虑分库分表的方案，以具备该能力。</p>

	
	</div>
  <a type="button" href="/2020/04/20/数据库性能优化分析/#more" class="btn btn-default more">阅读此文</a>
</div>

           
		
           
			  
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2018-09-13 </div>
			<div class="article-title"><a href="/2018/09/13/win10上PyCharm选择本地docker镜像中解释器报NullPointerException解决方案/" title="在win10中使用PyCharm进行Python开发，通过Docker搭建本地开发环境会比较方便。我在这个过程中遇到了一个纠结了很久的问题，docker-machine启动后，在PyCharm中选择项目解释器时会报异常，同时PyCharm中会显示docker-machine没有运行。">win10上PyCharm选择本地docker镜像中解释器报NullPointerException解决方案</a></div>						
		</h3>
	


			  <div class="entry">
  <div class="row">
	
	
		<p>&emsp;&emsp;在win10中使用PyCharm进行Python开发，通过Docker搭建本地开发环境会比较方便。我在这个过程中遇到了一个纠结了很久的问题，docker-machine启动后，在PyCharm中选择项目解释器时，会报NullPointerException异常，同时PyCharm中会显示docker-machine没有运行。问题的现象如下，在PyCharm中选择Docker Machine时，会上报如下图的异常：  </p>
<p><img src="http://odnk9as2f.bkt.clouddn.com/win10%E4%B8%8Apycharm%E6%97%A0%E6%B3%95%E8%BF%9E%E6%8E%A5%E6%9C%AC%E5%9C%B0docker1.png" alt="选择Docker Machine异常">  </p>
<p>而在选择TCP socket时，会上报如下图的异常：  </p>
<p><img src="http://odnk9as2f.bkt.clouddn.com/win10%E4%B8%8Apycharm%E6%97%A0%E6%B3%95%E8%BF%9E%E6%8E%A5%E6%9C%AC%E5%9C%B0docker2.png" alt="选择TCP socket异常">  </p>
<p>&emsp;&emsp;这个问题只会在windows上出现，mac上不会存在，我困扰了好几天，加起来大概有10个小时左右，在网上各种搜索也没有找到类似问题，小伙伴有的觉得是path路径写错，有的觉得是docker安装有问题。。。最后我在导师的指点下找到了解决方案，那就是：<strong>以管理员身份运行PyCharm</strong>。<br>&emsp;&emsp;对于win10，我还能说啥呢（摊手）。</p>

	
	</div>
  <a type="button" href="/2018/09/13/win10上PyCharm选择本地docker镜像中解释器报NullPointerException解决方案/#more" class="btn btn-default more">阅读此文</a>
</div>

           
		
           
			  
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2018-06-01 </div>
			<div class="article-title"><a href="/2018/06/01/磁盘分区与Ext2文件系统/" title="磁盘分区与Linux的Ext2文件系统简介。">磁盘分区与Ext2文件系统</a></div>						
		</h3>
	


			  <div class="entry">
  <div class="row">
	
	
		<h1 id="磁盘分区与文件系统结构"><a href="#磁盘分区与文件系统结构" class="headerlink" title="磁盘分区与文件系统结构"></a>磁盘分区与文件系统结构</h1><p>&emsp;&emsp;磁盘分区的逻辑结构以及磁盘分区与Ext2文件系统的关系简图如下图所示：</p>
<p><img src="http://odnk9as2f.bkt.clouddn.com/%E7%A3%81%E7%9B%98%E5%88%86%E5%8C%BA%E4%B8%8EExt2%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F1.png" alt="磁盘分区与Ext2文件系统关系">  </p>
<p>注意以下几点：  </p>
<ul>
<li>每个分区都有一个启动扇区（boot sector）。  </li>
<li>superblock一般只在每个分区的第一个block group中有，后续的block group中不一定有，即使有，也主要是作为第一个block group中superblock的备份。</li>
<li>每个文件和目录都对应一个inode以及一些block。</li>
<li>目录的inode中记录该目录的相关权限和属性，并记录分配到的block号码；目录的block中记录该目录下的<strong>文件名</strong>和该文件名占用的<strong>inode号码</strong>。  </li>
</ul>
<h1 id="软硬连接"><a href="#软硬连接" class="headerlink" title="软硬连接"></a>软硬连接</h1><ul>
<li>硬连接（hard link）：多个文件名连接到同一个inode号码关联的记录</li>
<li>软链接/符号连接（symbolic link）：创建一个独立的文件，该文件让数据读取指向它所连接的文件的文件名。数据读取时通过文件名连接到正确的目录，在目录block中找到该文件名对应的inode，最终读取正确数据</li>
</ul>

	
	</div>
  <a type="button" href="/2018/06/01/磁盘分区与Ext2文件系统/#more" class="btn btn-default more">阅读此文</a>
</div>

           
		
           
			  
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2017-09-04 </div>
			<div class="article-title"><a href="/2017/09/04/FreeMarker模板引擎实战/" title="FreeMarker是一个模板引擎：它是一个Java库，基于模板和要改变的数据生成输出文本（HTML网页、电子邮件、配置文件、源代码等）。本文通过一个小demo来说明FreeMarker的使用方式。">FreeMarker模板引擎实战</a></div>						
		</h3>
	


			  <div class="entry">
  <div class="row">
	
	
		<p>&emsp;&emsp;FreeMarker是一个模板引擎：它是一个Java库，基于模板和要改变的数据生成输出文本（HTML网页、电子邮件、配置文件、源代码等）。<br>&emsp;&emsp;笔者在项目开发过程中遇到了FreeMarker的使用场景，因此阅读了官方的文档。本文不会记录FreeMarker各种表达式、标签和指令的使用，更加侧重于模板引擎整体的使用。</p>
<h2 id="基本概念和术语"><a href="#基本概念和术语" class="headerlink" title="基本概念和术语"></a>基本概念和术语</h2><p>&emsp;&emsp;如官方手册中所言，<code>模板+数据模型=输出</code>。在FreeMarker中，首先要定义一个文件模板，如html，将其中需要动态传值的数据通过FreeMarker中的表达式、标签或自定义标签替换。再定义数据模型，通常是通过Java中的类来封装数据。使用时后台会读取模板和数据模型，将数据嵌入模板，然后生成新的html页面，提供给我们静态化访问。  </p>
<h3 id="数据模型详解"><a href="#数据模型详解" class="headerlink" title="数据模型详解"></a>数据模型详解</h3><p>&emsp;&emsp;FreeMarker中的数据模型是一个树形的结构，如下所示:  </p>
<pre> 
(root)
  |
  +- animals
  |   |
  |   +- mouse
  |   |   |
  |   |   +- size = "small"
  |   |   |
  |   |   +- price = 50
  |   |
  |   +- elephant
  |   |   |
  |   |   +- size = "large"
  |   |   |
  |   |   +- price = 5000
  |   |
  |   +- python
  |       |
  |       +- size = "medium"
  |       |
  |       +- price = 4999
  |
  +- message = "It is a test"
  |
  +- misc
      |
      +- foo = "Something"
</pre>  

<p>&emsp;&emsp;其中有一些术语，上图中的根节点、mouse、elephant、python、misc这些非叶子结点，在上图中类似于一个目录，它们被称为<strong>hash</strong>，它们保存其他的叶子变量。<br>&emsp;&emsp;上图中保存单个值的变量，如size、price、message、foo，被称为<strong>scalar</strong>，scalar支持的数据类型为：String、数字、日期时间、布尔值。要读取scalar，可以通过“.”符号，如要读取上图中的foo，可以写成misc.foo。<br>&emsp;&emsp;如果上图中的animals目录下的mouse、elephant、python均没有具体的名字，则animals被称为<strong>sequences</strong>，sequence下的目录均为hash，但它们没有具体的名字，表示存在于一个列表中的项，可以通过索引来取到，如要取上图中的animals.python.size，也可以通过animals[2].size取到，就像Java中的列表一样。  </p>
<h2 id="模板引擎的使用"><a href="#模板引擎的使用" class="headerlink" title="模板引擎的使用"></a>模板引擎的使用</h2><h3 id="使用步骤"><a href="#使用步骤" class="headerlink" title="使用步骤"></a>使用步骤</h3><p>&emsp;&emsp;使用FreeMarker主要有以下几个步骤：</p>
<ol>
<li>创建freemarker.template.Configuration类的实例并设置其属性。Configuration类的实例是用来存储freemarer应用级设置的核心容器，它负责创建和捕获预解析的模板（即Template对象）。  </li>
<li>创建数据模型，数据模型中的hash（用来存储其他有名字的数据项）可以是Map也可以是JavaBeans，只要它拥有public的getXxx或isXxx方法。</li>
<li>获取模板文件，模板由freemarker.template.Template类的实例所表示，Template类实例通过Configuration类实例的getTemplate()方法获得。Template实例用一种解析过后的格式来存储模板，而非纯文本。如果模板文件丢失或语法错误，则getTemplate()方法将会抛出异常。Configuration实例容器会缓存Template实例，下次通过getTemplate()获取同一个模板时，不会重新解析，而是返回缓存中的同一个Template实例。  </li>
<li>将数据模型合并至模板中，并产生输出文件。通过Template实例对象的process()方法。一个Template实例对象一旦创建出来，它可以与多个数据模型进行多次合并。  </li>
</ol>
<h3 id="代码示例"><a href="#代码示例" class="headerlink" title="代码示例"></a>代码示例</h3><p>&emsp;&emsp;下面就对应上面相应的步骤，给出代码示例：<br>&emsp;&emsp;主流程类Test.java：  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.edu.whu.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> freemarker.template.Configuration;</span><br><span class="line"><span class="keyword">import</span> freemarker.template.Template;</span><br><span class="line"><span class="keyword">import</span> freemarker.template.TemplateExceptionHandler;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.OutputStreamWriter;</span><br><span class="line"><span class="keyword">import</span> java.io.Writer;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wawu</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@create</span> 2017/9/4</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* ------------------------------------------------------------------------ */</span></span><br><span class="line">        <span class="comment">/* Step1：实例化Configuration类并设置其属性。</span></span><br><span class="line"><span class="comment">            注意：</span></span><br><span class="line"><span class="comment">            1. 整个应用周期中只需要实例化一次</span></span><br><span class="line"><span class="comment">            2. Configuration类对象是单例的</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        Configuration cfg = <span class="keyword">new</span> Configuration(Configuration.VERSION_2_3_25);</span><br><span class="line">        cfg.setDirectoryForTemplateLoading(<span class="keyword">new</span> File(<span class="string">"/Users/wuwenan/Development/IdeaProjects/FreemarkerTest/src/main/resources"</span>));</span><br><span class="line">        cfg.setDefaultEncoding(<span class="string">"UTF-8"</span>);</span><br><span class="line">        cfg.setTemplateExceptionHandler(TemplateExceptionHandler.RETHROW_HANDLER);</span><br><span class="line">        cfg.setLogTemplateExceptions(<span class="keyword">false</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* ------------------------------------------------------------------------ */</span></span><br><span class="line">        <span class="comment">/* Step2：创建数据模型</span></span><br><span class="line"><span class="comment">            注意：</span></span><br><span class="line"><span class="comment">            1. 在应用的生命周期中，可能会需要创建多次，每一个模板需要对应一个数据模型</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        Map&lt;String, Object&gt; root = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        root.put(<span class="string">"user"</span>, <span class="string">"Big Joe"</span>);</span><br><span class="line">        Product latest = <span class="keyword">new</span> Product();</span><br><span class="line">        latest.setUrl(<span class="string">"products/greenmouse.html"</span>);</span><br><span class="line">        latest.setName(<span class="string">"green mouse"</span>);</span><br><span class="line">        root.put(<span class="string">"latestProduct"</span>, latest);</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* Step3：从文件获得模板，文件为test.ftl*/</span></span><br><span class="line">        Template temp = cfg.getTemplate(<span class="string">"test.ftl"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">/*Step4：将数据模型合并至模板中*/</span></span><br><span class="line">        Writer out = <span class="keyword">new</span> OutputStreamWriter(<span class="keyword">new</span> FileOutputStream(<span class="string">"/Users/wuwenan/Development/IdeaProjects/FreemarkerTest/src/main/resources/test.html"</span>));</span><br><span class="line">        temp.process(root, out);</span><br><span class="line"></span><br><span class="line">        <span class="comment">/*注意：根据out对象的不同，可能需要调用out.close()方法（通常输出为文件时需要调用），</span></span><br><span class="line"><span class="comment">            但在Web应用中不需要调用*/</span></span><br><span class="line">        out.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;代码中用到的模板test.ftl：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Welcome!<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Welcome $&#123;user&#125;!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Our latest product:</span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"$&#123;latestProduct.url&#125;"</span>&gt;</span>$&#123;latestProduct.name&#125;<span class="tag">&lt;/<span class="name">a</span>&gt;</span>!</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;代码中用到的实体类Product.java：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.edu.whu.test;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> wawu</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@create</span> 2017/9/4</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Product</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String url;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// As per the JavaBeans spec., this defines the "url" bean property</span></span><br><span class="line">    <span class="comment">// It must be public!</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getUrl</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> url;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUrl</span><span class="params">(String url)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.url = url;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// As per the JavaBean spec., this defines the "name" bean property</span></span><br><span class="line">    <span class="comment">// It must be public!</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

	
	</div>
  <a type="button" href="/2017/09/04/FreeMarker模板引擎实战/#more" class="btn btn-default more">阅读此文</a>
</div>

           
		
           
			  
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2017-08-11 </div>
			<div class="article-title"><a href="/2017/08/11/Intellij-IDEA-操作笔记/" title="本文为笔者在学习和使用Intellij IDEA过程中踩坑的记录。">Intellij IDEA 操作笔记</a></div>						
		</h3>
	


			  <div class="entry">
  <div class="row">
	
	
		<p>&emsp;&emsp;Intellij IDEA被认为是目前最优秀的java开发IDE，但其使用习惯与Eclipse存在较大的差异，笔者将自己学习和使用过程中所用到的一些操作记录下来，以便查阅。  </p>
<ul>
<li><p><strong>IntelliJ导入jar包：</strong></p>
<ul>
<li>File-&gt;Project Structure-&gt;Modules-&gt;Dependencies-&gt;add-&gt;JARs or directories  </li>
</ul>
</li>
<li><p><strong>IntelliJ连接 tomcat 服务器：</strong></p>
<ul>
<li>Edit Configuration-&gt;Tomcat Server-&gt;add-&gt;Deployment-&gt;add-&gt;Artifact-&gt;选择 Module-&gt; 在右边窗口填写 Application context</li>
</ul>
</li>
<li><p><strong>IntelliJ连接 MySQL 数据库：</strong></p>
<ul>
<li>导入 MySQL 数据库 jdbc 的 jar 包：File-&gt;Project Structure-&gt;Modules-&gt;Dependencies-&gt;add-&gt;JARs or directories选择jdbc 驱动 jar 包<ul>
<li>Web 项目连接数据库：导入 jdbc的 jar 包-&gt;File-&gt;Project Structure-&gt;Artifacts-&gt;将右边的 jar 包拖入左边的WEB-INF中的 lib 文件夹</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>IntelliJ查看 Web 项目编译输出地址：</strong></p>
<ul>
<li>File-&gt;Project Structure-&gt;Project-&gt;查看Project compiler output路径</li>
</ul>
</li>
<li><p><strong>IntelliJ导入javax.servlet包：</strong></p>
<ul>
<li>File-&gt;Project Structure-&gt;Modules-&gt;add-&gt;Libraries-&gt; 选择 Tomcat文件夹下的lib文件夹-&gt;选择servlet-api.jar</li>
<li>Intellij中的web项目，jsp页面里面部分内置对象的方法无法解析，如request.getParameter()，需要导入tomcat下的servlet-api.jar            </li>
</ul>
</li>
<li><p><strong>解决运行Web Server时控制台中文输出乱码问题：</strong></p>
<ul>
<li>Run/Debug Configurations -&gt;Server-&gt;VM options中填写-Dfile.encoding=UTF-8</li>
</ul>
</li>
<li><p><strong>IntelliJ生成javadoc：</strong></p>
<ul>
<li>在 “Tools-&gt;Gerenate JavaDoc” 面版的 “Other command line arguments:” 栏里输入 “-encoding utf-8 -charset utf-8”以更改生成的javadoc的字符集</li>
</ul>
</li>
<li><p><strong>IntelliJ为java程序输入运行时的参数：</strong></p>
<ul>
<li>Edit Configurations —&gt; 在Program arguments中输入参数</li>
<li>e.g. 在SortCompare 用例类的 Program arguments中输入参数”1000”效果等于在终端输入“java SortCompare 1000”</li>
</ul>
</li>
<li><p><strong>IntelliJ为项目添加JUnit：</strong></p>
<ul>
<li>方法一：自定义生成测试类 cmd+shift+T—&gt;create new test…</li>
<li>方法二：使用junit generator生成测试类 control+return—&gt;JUnit Test</li>
<li>方法三：使用junit generator生成测试类 工具栏code—&gt;Generate，然后同方法二</li>
</ul>
</li>
<li><p><strong>IntelliJ运行Maven命令：</strong></p>
<ul>
<li>在Maven项目界面右边Maven Projects—&gt;Lifecycle—&gt;选择Maven命令</li>
</ul>
</li>
<li><p><strong>IntelliJ创建Maven管理的Web项目的两种方式：</strong></p>
<ul>
<li>第一种：先创建普通maven项目，再增加框架支持</li>
<li>第二种：直接通过archetype创建maven项目（推荐）</li>
</ul>
</li>
<li><p><strong>IntelliJ自己创建命令工具宏：</strong></p>
<ul>
<li>Preference -&gt; Tools -&gt; External Tools -&gt; “+” -&gt; 编辑各个参数</li>
<li>具体参数内容查看<a href="https://www.jetbrains.com/help/idea/create-edit-copy-tool-dialog.html" target="_blank" rel="noopener">官方文档</a></li>
</ul>
</li>
</ul>

	
	</div>
  <a type="button" href="/2017/08/11/Intellij-IDEA-操作笔记/#more" class="btn btn-default more">阅读此文</a>
</div>

           
		
           
			  
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2017-07-14 </div>
			<div class="article-title"><a href="/2017/07/14/Java——通配符和泛型边界/" title="Java泛型中有一个比较容易令人困惑的知识点：泛型的边界，而讨论泛型的边界则要涉及到通配符“？”的使用，本文将对此进行讲解。">Java——通配符和泛型边界</a></div>						
		</h3>
	


			  <div class="entry">
  <div class="row">
	
	
		<p>&emsp;&emsp;本文源起于笔者在阅读《Thinking in Java》泛型章节的时候，遇到的关于泛型边界的时候思考的一个问题，笔者就该问题分别询问了三位硕士小伙伴，大家都没有回答正确，因此笔者觉得有必要对此进行一个辨析。问题本身并不复杂，且听我细细道来。<br>&emsp;&emsp;首先，假设有四个类存在如下的继承关系：  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Fruit</span> </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Apple</span> <span class="keyword">extends</span> <span class="title">Fruit</span> </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Jonathan</span> <span class="keyword">extends</span> <span class="title">Apple</span> </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Orange</span> <span class="keyword">extends</span> <span class="title">Fruit</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;<code>Fruit</code>类是超类，<code>Apple</code>和<code>Orange</code>继承了<code>Fruit</code>，而<code>Jonathan</code>继承了<code>Apple</code>。  </p>
<h1 id="泛型不存在协变"><a href="#泛型不存在协变" class="headerlink" title="泛型不存在协变"></a>泛型不存在协变</h1><p>&emsp;&emsp;首先我们来看这样一段代码：  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> generics;<span class="comment">//: generics/NonCovariantGenerics.java</span></span><br><span class="line"><span class="comment">// &#123;CompileTimeError&#125; (Won't compile)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NonCovariantGenerics</span> </span>&#123;</span><br><span class="line">    <span class="comment">// Compile Error: incompatible types:</span></span><br><span class="line">    List&lt;Fruit&gt; flist = <span class="keyword">new</span> ArrayList&lt;Apple&gt;();</span><br><span class="line">&#125; <span class="comment">///:~</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;从注释上可以看到，这段代码是无法通过编译的。你可能以为在第9行里，用<code>Apple</code>类型的ArrayList来初始化<code>Fruit</code>类型的List是向上转型，然而这并不是向上转型，<code>Apple</code>类型的List不是<code>Fruit</code>类型的List，因为<code>Apple</code>类型的List可以持有<code>Apple</code>对象及其子类对象，而<code>Fruit</code>类型的List将持有<code>Fruit</code>类型对象及其子类对象，包括<code>Apple</code>类型对象，它可持有的范围更大。<br>&emsp;&emsp;因此<strong>不能用<code>Apple</code>类型的List初始化<code>Fruit</code>类型的List</strong>，这说明<strong>泛型不存在协变类型</strong>。  </p>
<h1 id="通配符表示的泛型的下界"><a href="#通配符表示的泛型的下界" class="headerlink" title="通配符表示的泛型的下界"></a>通配符表示的泛型的下界</h1><p>&emsp;&emsp;但你还是想建立某种向上转型的关系，于是你想到了通配符：<code>？</code>，你可能会想到像下面这样来使用它：  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> generics;<span class="comment">//: generics/GenericsAndCovariance.java</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GenericsAndCovariance</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// Wildcards allow covariance:</span></span><br><span class="line">        List&lt;? extends Fruit&gt; flist = <span class="keyword">new</span> ArrayList&lt;Apple&gt;();</span><br><span class="line">        <span class="comment">// Compile Error: can't add any type of object:</span></span><br><span class="line">        <span class="comment">// flist.add(new Apple());</span></span><br><span class="line">        <span class="comment">// flist.add(new Fruit());</span></span><br><span class="line">        <span class="comment">// flist.add(new Object());</span></span><br><span class="line">        flist.add(<span class="keyword">null</span>); <span class="comment">// Legal but uninteresting</span></span><br><span class="line">        <span class="comment">// We know that it returns at least Fruit:</span></span><br><span class="line">        Fruit f = flist.get(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="comment">///:~</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;很遗憾，从注释中你可以看到，像上面那样使用<code>extends</code>关键字，虽然可以通过编译，但在为List中添加对象的时候，是无法成功的，不论你添加的是<code>Fruit</code>本身，还是它的子类，甚至是<code>Object</code>，都无法添加成功。你唯一可以做的是从List中读取对象。<br>&emsp;&emsp;那么为什么不可以往该容器中装对象呢？因为<code>List&lt;? extends Fruit&gt;</code>表示该List持有的是<strong>“Fruit类的某个不确定的子类型”</strong>，但编译器并不知道该List中持有的究竟是<code>Fruit</code>的哪个子类型，因此无法将诸如<code>Apple</code>的<code>Fruit</code>的某个具体子类型装入该List，同时<code>Fruit</code>本身也不能被装入，当然，<code>Fruit</code>的父类型<code>Object</code>就更加不可以了，装入这些类时的转型都不是类型安全的。因此，这个通配符表示的泛型下界可以说是无下限的。<br>&emsp;&emsp;那么为什么可以调用<code>get()</code>方法来读取该List呢？我们已经知道该List中持有的一定是<code>Fruit</code>的某个子类型，因此它的上界是确定的，就是<code>Fruit</code>，因此当取出的时候，将它赋值给一个静态类型为<code>Fruit</code>的对象，就属于向上转型，因此是没有问题的。  </p>
<h1 id="通配符表示的泛型上界"><a href="#通配符表示的泛型上界" class="headerlink" title="通配符表示的泛型上界"></a>通配符表示的泛型上界</h1><p>&emsp;&emsp;通配符还有一种用法，就是表示泛型的上界，如下面所示：    </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> generics;<span class="comment">//: generics/SuperTypeWildcards.java</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SuperTypeWildcards</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">writeTo</span><span class="params">(List&lt;? <span class="keyword">super</span> Apple&gt; apples)</span> </span>&#123;</span><br><span class="line">        apples.add(<span class="keyword">new</span> Apple());</span><br><span class="line">        apples.add(<span class="keyword">new</span> Jonathan());</span><br><span class="line">        <span class="comment">// apples.add(new Fruit()); // Error</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="comment">///:~</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;像上面这样使用<code>List&lt;? super Apple&gt;</code>，就可以向List中添加<code>Apple</code>及其子类<code>Jonathan</code>了，但向其中添加<code>Apple</code>的父类<code>Fruit</code>则是不安全的。原因是<code>List&lt;? super Apple&gt;</code>表示该List持有的是<strong>Apple的某个不确定的超类型</strong>，既然该List中持有的一定是<code>Apple</code>的某个超类型，那么使用<code>add()</code>方法向其中添加<code>Apple</code>及其子类型，一定是类型安全的；但由于编译器只知道这个List持有的是<code>Apple</code>的某个超类型，但不能确定究竟是哪个超类型，因此向其中添加<code>Fruit</code>类型是不安全的。</p>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>&emsp;&emsp;总结一下就是：  </p>
<ul>
<li><strong>&lt;? extends T&gt;</strong> 表示T的某个不确定的子类，因此不能存放具体的T类对象及其子类，更不能存放T的父类，因此<code>Object</code>类不能存放。</li>
<li><strong>&lt;? super T&gt;</strong> 表示T的某个不确定的超类，因此可以存放T类对象及T的子类对象。</li>
</ul>

	
	</div>
  <a type="button" href="/2017/07/14/Java——通配符和泛型边界/#more" class="btn btn-default more">阅读此文</a>
</div>

           
		
           
			  
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2017-06-25 </div>
			<div class="article-title"><a href="/2017/06/25/使用栈数据结构模拟递归时系统调用栈的行为/" title="本文通过利用栈数据结构将一个简单的递归方法改写为为使用循环的方法，模拟了系统调用栈在处理递归时的行为。">使用栈数据结构模拟递归时系统调用栈的行为</a></div>						
		</h3>
	


			  <div class="entry">
  <div class="row">
	
	
		<p>&emsp;&emsp;递归是经典的算法思想，递归的代码优美而简洁易懂。系统在处理递归时，使用系统调用栈来保存递归调用点的内存地址，以保证在返回时能够回到上一层方法的调用点继续执行。本文通过利用栈数据结构将一个简单的递归方法改写为为使用循环的方法，模拟了系统调用栈在处理递归时的行为。理解系统调用栈的行为，有助于我们对递归有更加深刻的理解。<br>&emsp;&emsp;下面给出递归方法的代码和改写后的代码：  </p>
<ul>
<li>递归方法：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> systemStack;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by wuwenan on 25/06/2017.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Recursion</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">Foo</span><span class="params">(<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(n&lt;=<span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> n*Foo(n-<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        System.out.println(Foo(<span class="number">10</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;这是一个简单的递归方法，其中递归的部分为<strong>f(n)=n*f(n-1)</strong>，下面将该方法改写为使用循环的方法。递归的调用分为两个阶段，第一阶段为<code>call</code>阶段，是从上层向下层一层层调用的阶段；第二阶段为<code>return</code>阶段，是从递归边界开始从下层想上层一层层返回的阶段。</p>
<ul>
<li>改写后的循环方法：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> systemStack;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Stack;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * java模拟递归调用的系统栈</span></span><br><span class="line"><span class="comment"> * Created by wuwenan on 25/06/2017.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SystemStack</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">Foo</span><span class="params">(<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">        <span class="comment">//使用栈模拟系统栈的行为</span></span><br><span class="line">        Stack&lt;Integer&gt; systemStack = <span class="keyword">new</span> Stack&lt;&gt;();</span><br><span class="line">        <span class="comment">//back为true，表示递归调用的返回过程；back若为false，表示递归调用的调用过程</span></span><br><span class="line">        <span class="keyword">boolean</span> back = <span class="keyword">false</span>;</span><br><span class="line">        <span class="keyword">int</span> result=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">do</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(!back)&#123;</span><br><span class="line">                <span class="comment">//调用过程</span></span><br><span class="line">                <span class="keyword">if</span>(n&lt;=<span class="number">1</span>)&#123;</span><br><span class="line">                    back = <span class="keyword">true</span>;</span><br><span class="line">                    result = <span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                systemStack.push(n);</span><br><span class="line">                n--;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="comment">//返回过程</span></span><br><span class="line">                result*=systemStack.pop();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">while</span>(!systemStack.isEmpty());</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        System.out.println(Foo(<span class="number">10</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;上面的代码中使用了栈的数据结构模拟了系统调用栈的过程。这段代码有以下几个注意点：</p>
<ul>
<li>使用boolean类型变量<code>back</code>标识递归的调用和返回过程，若back值为true，表示当前的过程为return过程；若back值为false，表示当前过程为call过程。</li>
<li>在call过程中将每一层使用到的n值放入栈中</li>
<li>在return过程中将栈中的值一个个取出以和之前一次执行的结果相乘。</li>
<li><p>递归的边界是<strong>n&lt;=1</strong>。</p>
<p>&emsp;&emsp;两段代码输出的结果均为：</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">3628800</span></span><br></pre></td></tr></table></figure>
	
	</div>
  <a type="button" href="/2017/06/25/使用栈数据结构模拟递归时系统调用栈的行为/#more" class="btn btn-default more">阅读此文</a>
</div>

           
		
           
			  
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2017-06-16 </div>
			<div class="article-title"><a href="/2017/06/16/Java——Java虚拟机指令集/" title="JVM指令集列表的整理，以便将来review。">Java——Java虚拟机指令集</a></div>						
		</h3>
	


			  <div class="entry">
  <div class="row">
	
	
		<h1 id="JVM指令集"><a href="#JVM指令集" class="headerlink" title="JVM指令集"></a>JVM指令集</h1><p>0x00 nop      什么都不做<br>0x01 aconst_null 将null推送至操作栈栈顶<br>0x02 iconst_m1   将int型-1推送至操作栈栈顶<br>0x03 iconst_0   将int型0推送至操作栈栈顶<br>0x04 iconst_1   将int型1推送至操作栈栈顶<br>0x05 iconst_2   将int型2推送至操作栈栈顶<br>0x06 iconst_3   将int型3推送至操作栈栈顶<br>0x07 iconst_4   将int型4推送至操作栈栈顶<br>0x08 iconst_5   将int型5推送至操作栈栈顶<br>0x09 lconst_0   将long型0推送至操作栈栈顶<br>0x0a lconst_1   将long型1推送至操作栈栈顶<br>0x0b fconst_0   将float型0推送至操作栈栈顶<br>0x0c fconst_1   将float型1推送至操作栈栈顶<br>0x0d fconst_2   将float型2推送至操作栈栈顶<br>0x0e dconst_0   将double型0推送至操作栈栈顶<br>0x0f dconst_1   将double型1推送至操作栈栈顶<br>0x10 bipush    将单字节的常量值(-128~127)推送至操作栈栈顶<br>0x11 sipush    将一个短整型常量值(-32768~32767)推送至操作栈栈顶<br>0x12 ldc      将int, float或String型常量值从常量池中推送至操作栈栈顶<br>0x13 ldc_w     将int, float或String型常量值从常量池中推送至操作栈栈顶（宽索引）<br>0x14 ldc2_w    将long或double型常量值从常量池中推送至操作栈栈顶（宽索引）<br>0x15 iload     将指定的int型局部变量推送至操作栈栈顶<br>0x16 lload     将指定的long型局部变量推送至操作栈栈顶<br>0x17 fload     将指定的float型局部变量推送至操作栈栈顶<br>0x18 dload     将指定的double型局部变量推送至操作栈栈顶<br>0x19 aload     将指定的引用类型局部变量推送至操作栈栈顶<br>0x1a iload_0    将第一个int型局部变量推送至操作栈栈顶<br>0x1b iload_1    将第二个int型局部变量推送至操作栈栈顶<br>0x1c iload_2    将第三个int型局部变量推送至操作栈栈顶<br>0x1d iload_3    将第四个int型局部变量推送至操作栈栈顶<br>0x1e lload_0    将第一个long型局部变量推送至操作栈栈顶<br>0x1f lload_1    将第二个long型局部变量推送至操作栈栈顶<br>0x20 lload_2    将第三个long型局部变量推送至操作栈栈顶<br>0x21 lload_3    将第四个long型局部变量推送至操作栈栈顶<br>0x22 fload_0    将第一个float型局部变量推送至操作栈栈顶<br>0x23 fload_1    将第二个float型局部变量推送至操作栈栈顶<br>0x24 fload_2    将第三个float型局部变量推送至操作栈栈顶<br>0x25 fload_3    将第四个float型局部变量推送至操作栈栈顶<br>0x26 dload_0    将第一个double型局部变量推送至操作栈栈顶<br>0x27 dload_1    将第二个double型局部变量推送至操作栈栈顶<br>0x28 dload_2    将第三个double型局部变量推送至操作栈栈顶<br>0x29 dload_3    将第四个double型局部变量推送至操作栈栈顶<br>0x2a aload_0    将第一个引用类型局部变量推送至操作栈栈顶<br>0x2b aload_1    将第二个引用类型局部变量推送至操作栈栈顶<br>0x2c aload_2    将第三个引用类型局部变量推送至操作栈栈顶<br>0x2d aload_3    将第四个引用类型局部变量推送至操作栈栈顶<br>0x2e iaload    将int型数组指定索引的值推送至操作栈栈顶<br>0x2f laload    将long型数组指定索引的值推送至操作栈栈顶<br>0x30 faload    将float型数组指定索引的值推送至操作栈栈顶<br>0x31 daload    将double型数组指定索引的值推送至操作栈栈顶<br>0x32 aaload    将引用型数组指定索引的值推送至操作栈栈顶<br>0x33 baload    将boolean或byte型数组指定索引的值推送至操作栈栈顶<br>0x34 caload    将char型数组指定索引的值推送至操作栈栈顶<br>0x35 saload    将short型数组指定索引的值推送至操作栈栈顶<br>0x36 istore    将操作栈栈顶int型数值存入指定局部变量<br>0x37 lstore    将操作栈栈顶long型数值存入指定局部变量<br>0x38 fstore    将操作栈栈顶float型数值存入指定局部变量<br>0x39 dstore    将操作栈栈顶double型数值存入指定局部变量<br>0x3a astore    将操作栈栈顶引用型数值存入指定局部变量<br>0x3b istore_0   将操作栈栈顶int型数值存入第一个局部变量<br>0x3c istore_1   将操作栈栈顶int型数值存入第二个局部变量<br>0x3d istore_2   将操作栈栈顶int型数值存入第三个局部变量<br>0x3e istore_3   将操作栈栈顶int型数值存入第四个局部变量<br>0x3f lstore_0   将操作栈栈顶long型数值存入第一个局部变量<br>0x40 lstore_1   将操作栈栈顶long型数值存入第二个局部变量<br>0x41 lstore_2   将操作栈栈顶long型数值存入第三个局部变量<br>0x42 lstore_3   将操作栈栈顶long型数值存入第四个局部变量<br>0x43 fstore_0   将操作栈栈顶float型数值存入第一个局部变量<br>0x44 fstore_1   将操作栈栈顶float型数值存入第二个局部变量<br>0x45 fstore_2   将操作栈栈顶float型数值存入第三个局部变量<br>0x46 fstore_3   将操作栈栈顶float型数值存入第四个局部变量<br>0x47 dstore_0   将操作栈栈顶double型数值存入第一个局部变量<br>0x48 dstore_1   将操作栈栈顶double型数值存入第二个局部变量<br>0x49 dstore_2   将操作栈栈顶double型数值存入第三个局部变量<br>0x4a dstore_3   将操作栈栈顶double型数值存入第四个局部变量<br>0x4b astore_0   将操作栈栈顶引用型数值存入第一个局部变量<br>0x4c astore_1   将操作栈栈顶引用型数值存入第二个局部变量<br>0x4d astore_2   将操作栈栈顶引用型数值存入第三个局部变量<br>0x4e astore_3   将操作栈栈顶引用型数值存入第四个局部变量<br>0x4f iastore    将操作栈栈顶int型数值存入指定数组的指定索引位置<br>0x50 lastore    将操作栈栈顶long型数值存入指定数组的指定索引位置<br>0x51 fastore    将操作栈栈顶float型数值存入指定数组的指定索引位置<br>0x52 dastore    将操作栈栈顶double型数值存入指定数组的指定索引位置<br>0x53 aastore    将操作栈栈顶引用型数值存入指定数组的指定索引位置<br>0x54 bastore    将操作栈栈顶boolean或byte型数值存入指定数组的指定索引位置<br>0x55 castore    将操作栈栈顶char型数值存入指定数组的指定索引位置<br>0x56 sastore    将操作栈栈顶short型数值存入指定数组的指定索引位置<br>0x57 pop      将操作栈栈顶数值弹出 (数值不能是long或double类型的)<br>0x58 pop2     将操作栈栈顶的一个（long或double类型的)或两个数值弹出（其它）<br>0x59 dup      复制操作栈栈顶数值并将复制值压入操作栈栈顶<br>0x5a dup_x1    复制操作栈栈顶数值并将两个复制值压入操作栈栈顶<br>0x5b dup_x2    复制操作栈栈顶数值并将三个（或两个）复制值压入操作栈栈顶<br>0x5c dup2     复制操作栈栈顶一个（long或double类型的)或两个（其它）数值并将复制值压入操作栈栈顶<br>0x5d dup2_x1    &lt;待补充&gt;<br>0x5e dup2_x2    &lt;待补充&gt;<br>0x5f swap     将栈最顶端的两个数值互换(数值不能是long或double类型的)<br>0x60 iadd     将操作栈栈顶两int型数值相加并将结果压入操作栈栈顶<br>0x61 ladd     将操作栈栈顶两long型数值相加并将结果压入操作栈栈顶<br>0x62 fadd     将操作栈栈顶两float型数值相加并将结果压入操作栈栈顶<br>0x63 dadd     将操作栈栈顶两double型数值相加并将结果压入操作栈栈顶<br>0x64 is      将操作栈栈顶两int型数值相减并将结果压入操作栈栈顶<br>0x65 ls      将操作栈栈顶两long型数值相减并将结果压入操作栈栈顶<br>0x66 fs      将操作栈栈顶两float型数值相减并将结果压入操作栈栈顶<br>0x67 ds      将操作栈栈顶两double型数值相减并将结果压入操作栈栈顶<br>0x68 imul     将操作栈栈顶两int型数值相乘并将结果压入操作栈栈顶<br>0x69 lmul     将操作栈栈顶两long型数值相乘并将结果压入操作栈栈顶<br>0x6a fmul     将操作栈栈顶两float型数值相乘并将结果压入操作栈栈顶<br>0x6b dmul     将操作栈栈顶两double型数值相乘并将结果压入操作栈栈顶<br>0x6c idiv     将操作栈栈顶两int型数值相除并将结果压入操作栈栈顶<br>0x6d ldiv     将操作栈栈顶两long型数值相除并将结果压入操作栈栈顶<br>0x6e fdiv     将操作栈栈顶两float型数值相除并将结果压入操作栈栈顶<br>0x6f ddiv     将操作栈栈顶两double型数值相除并将结果压入操作栈栈顶<br>0x70 irem     将操作栈栈顶两int型数值作取模运算并将结果压入操作栈栈顶<br>0x71 lrem     将操作栈栈顶两long型数值作取模运算并将结果压入操作栈栈顶<br>0x72 frem     将操作栈栈顶两float型数值作取模运算并将结果压入操作栈栈顶<br>0x73 drem     将操作栈栈顶两double型数值作取模运算并将结果压入操作栈栈顶<br>0x74 ineg     将操作栈栈顶int型数值取负并将结果压入操作栈栈顶<br>0x75 lneg     将操作栈栈顶long型数值取负并将结果压入操作栈栈顶<br>0x76 fneg     将操作栈栈顶float型数值取负并将结果压入操作栈栈顶<br>0x77 dneg     将操作栈栈顶double型数值取负并将结果压入操作栈栈顶<br>0x78 ishl     将int型数值左移位指定位数并将结果压入操作栈栈顶<br>0x79 lshl     将long型数值左移位指定位数并将结果压入操作栈栈顶<br>0x7a ishr     将int型数值右（符号）移位指定位数并将结果压入操作栈栈顶<br>0x7b lshr     将long型数值右（符号）移位指定位数并将结果压入操作栈栈顶<br>0x7c iushr     将int型数值右（无符号）移位指定位数并将结果压入操作栈栈顶<br>0x7d lushr     将long型数值右（无符号）移位指定位数并将结果压入操作栈栈顶<br>0x7e iand     将操作栈栈顶两int型数值作“按位与”并将结果压入操作栈栈顶<br>0x7f land     将操作栈栈顶两long型数值作“按位与”并将结果压入操作栈栈顶<br>0x80 ior      将操作栈栈顶两int型数值作“按位或”并将结果压入操作栈栈顶<br>0x81 lor      将操作栈栈顶两long型数值作“按位或”并将结果压入操作栈栈顶<br>0x82 ixor     将操作栈栈顶两int型数值作“按位异或”并将结果压入操作栈栈顶<br>0x83 lxor     将操作栈栈顶两long型数值作“按位异或”并将结果压入操作栈栈顶<br>0x84 iinc     将指定int型变量增加指定值（i++, i–, i+=2）<br>0x85 i2l      将操作栈栈顶int型数值强制转换成long型数值并将结果压入操作栈栈顶<br>0x86 i2f      将操作栈栈顶int型数值强制转换成float型数值并将结果压入操作栈栈顶<br>0x87 i2d      将操作栈栈顶int型数值强制转换成double型数值并将结果压入操作栈栈顶<br>0x88 l2i      将操作栈栈顶long型数值强制转换成int型数值并将结果压入操作栈栈顶<br>0x89 l2f      将操作栈栈顶long型数值强制转换成float型数值并将结果压入操作栈栈顶<br>0x8a l2d      将操作栈栈顶long型数值强制转换成double型数值并将结果压入操作栈栈顶<br>0x8b f2i      将操作栈栈顶float型数值强制转换成int型数值并将结果压入操作栈栈顶<br>0x8c f2l      将操作栈栈顶float型数值强制转换成long型数值并将结果压入操作栈栈顶<br>0x8d f2d      将操作栈栈顶float型数值强制转换成double型数值并将结果压入操作栈栈顶<br>0x8e d2i      将操作栈栈顶double型数值强制转换成int型数值并将结果压入操作栈栈顶<br>0x8f d2l      将操作栈栈顶double型数值强制转换成long型数值并将结果压入操作栈栈顶<br>0x90 d2f      将操作栈栈顶double型数值强制转换成float型数值并将结果压入操作栈栈顶<br>0x91 i2b      将操作栈栈顶int型数值强制转换成byte型数值并将结果压入操作栈栈顶<br>0x92 i2c      将操作栈栈顶int型数值强制转换成char型数值并将结果压入操作栈栈顶<br>0x93 i2s      将操作栈栈顶int型数值强制转换成short型数值并将结果压入操作栈栈顶<br>0x94 lcmp     比较操作栈栈顶两long型数值大小，并将结果（1，0，-1）压入操作栈栈顶<br>0x95 fcmpl     比较操作栈栈顶两float型数值大小，并将结果（1，0，-1）压入操作栈栈顶；当其中一个数值为NaN时，将-1压入操作栈栈顶<br>0x96 fcmpg     比较操作栈栈顶两float型数值大小，并将结果（1，0，-1）压入操作栈栈顶；当其中一个数值为NaN时，将1压入操作栈栈顶<br>0x97 dcmpl     比较操作栈栈顶两double型数值大小，并将结果（1，0，-1）压入操作栈栈顶；当其中一个数值为NaN时，将-1压入操作栈栈顶<br>0x98 dcmpg     比较操作栈栈顶两double型数值大小，并将结果（1，0，-1）压入操作栈栈顶；当其中一个数值为NaN时，将1压入操作栈栈顶<br>0x99 ifeq     当操作栈栈顶int型数值等于0时跳转<br>0x9a ifne     当操作栈栈顶int型数值不等于0时跳转<br>0x9b iflt     当操作栈栈顶int型数值小于0时跳转<br>0x9c ifge     当操作栈栈顶int型数值大于等于0时跳转<br>0x9d ifgt     当操作栈栈顶int型数值大于0时跳转<br>0x9e ifle     当操作栈栈顶int型数值小于等于0时跳转<br>0x9f if_icmpeq   比较操作栈栈顶两int型数值大小，当结果等于0时跳转<br>0xa0 if_icmpne   比较操作栈栈顶两int型数值大小，当结果不等于0时跳转<br>0xa1 if_icmplt   比较操作栈栈顶两int型数值大小，当结果小于0时跳转<br>0xa2 if_icmpge   比较操作栈栈顶两int型数值大小，当结果大于等于0时跳转<br>0xa3 if_icmpgt   比较操作栈栈顶两int型数值大小，当结果大于0时跳转<br>0xa4 if_icmple   比较操作栈栈顶两int型数值大小，当结果小于等于0时跳转<br>0xa5 if_acmpeq   比较操作栈栈顶两引用型数值，当结果相等时跳转<br>0xa6 if_acmpne   比较操作栈栈顶两引用型数值，当结果不相等时跳转<br>0xa7 goto     无条件跳转<br>0xa8 jsr      跳转至指定16位offset位置，并将jsr下一条指令地址压入操作栈栈顶<br>0xa9 ret      返回至局部变量指定的index的指令位置（一般与jsr, jsr_w联合使用）<br>0xaa tableswitch    用于switch条件跳转，case值连续（可变长度指令）<br>0xab lookupswitch   用于switch条件跳转，case值不连续（可变长度指令）<br>0xac ireturn    从当前方法返回int<br>0xad lreturn    从当前方法返回long<br>0xae freturn    从当前方法返回float<br>0xaf dreturn    从当前方法返回double<br>0xb0 areturn    从当前方法返回对象引用<br>0xb1 return    从当前方法返回void<br>0xb2 getstatic   获取指定类的静态域，并将其值压入操作栈栈顶<br>0xb3 putstatic   为指定的类的静态域赋值<br>0xb4 getfield   获取指定类的实例域，并将其值压入操作栈栈顶<br>0xb5 putfield   为指定的类的实例域赋值<br>0xb6 invokevirt l   调用实例方法<br>0xb7 invokespecial   调用实例构造器<init>方法，私有方法和父类方法<br>0xb8 invokestatic   调用静态方法<br>0xb9 invokeinterface 调用接口方法<br>0xba –<br>0xbb new      创建一个对象，并将其引用值压入操作栈栈顶<br>0xbc newarray   创建一个指定原始类型（如int, float, char…）的数组，并将其引用值压入操作栈栈顶<br>0xbd anewarray   创建一个引用型（如类，接口，数组）的数组，并将其引用值压入操作栈栈顶<br>0xbe arraylength 获得数组的长度值并压入操作栈栈顶<br>0xbf athrow    将操作栈栈顶的异常抛出<br>0xc0 checkcast   检验类型转换，检验未通过将抛出ClassCastException<br>0xc1 instanceof 检验对象是否是指定的类的实例，如果是将1压入操作栈栈顶，否则将0压入操作栈栈顶<br>0xc2 monitorenter   获得对象的锁，用于同步方法或同步块<br>0xc3 monitorexit    释放对象的锁，用于同步方法或同步块<br>0xc4 wide     &lt;待补充&gt;<br>0xc5 multianewarray   创建指定类型和指定维度的多维数组（执行该指令时，操作栈中必须包含各维度的长度值），并将其引用值压入操作栈栈顶<br>0xc6 ifnull    为null时跳转<br>0xc7 ifnonnull   不为null时跳转<br>0xc8 goto_w    无条件跳转（宽索引）<br>0xc9 jsr_w     跳转至指定32位offset位置，并将jsr_w下一条指令地址压入操作栈栈顶  </init></p>
<h1 id="JVM指令助记符"><a href="#JVM指令助记符" class="headerlink" title="JVM指令助记符"></a>JVM指令助记符</h1><p>局部变量到操作栈：iload,iload_,lload,lload_,fload,fload_,dload,dload_,aload,aload_<br>操作栈到局部变量：istore,istore_,lstore,lstore_,fstore,fstore_,dstore,dstor_,astore,astore_<br>常数到操作栈：bipush,sipush,ldc,ldc_w,ldc2_w,aconst_null,iconst_ml,iconst_,lconst_,fconst_,dconst_<br>加：iadd,ladd,fadd,dadd<br>减：is ,ls ,fs ,ds<br>乘：imul,lmul,fmul,dmul<br>除：idiv,ldiv,fdiv,ddiv<br>余数：irem,lrem,frem,drem<br>取负：ineg,lneg,fneg,dneg<br>移位：ishl,lshr,iushr,lshl,lshr,lushr<br>按位或：ior,lor<br>按位与：iand,land<br>按位异或：ixor,lxor<br>类型转换：i2l,i2f,i2d,l2f,l2d,f2d(放宽数值转换)<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;i2b,i2c,i2s,l2i,f2i,f2l,d2i,d2l,d2f(缩窄数值转换)<br>创建类实例：new<br>创建新数组：newarray,anewarray,multianwarray<br>访问类的域和类实例域：getfield,putfield,getstatic,putstatic<br>把数据装载到操作栈：baload,caload,saload,iaload,laload,faload,daload,aaload<br>从操作栈存存储到数组：bastore,castore,sastore,iastore,lastore,fastore,dastore,aastore<br>获取数组长度：arraylength<br>检相类实例或数组属性：instanceof,checkcast<br>操作栈管理：pop,pop2,dup,dup2,dup_xl,dup2_xl,dup_x2,dup2_x2,swap<br>有条件转移：ifeq,iflt,ifle,ifne,ifgt,ifge,ifnull,ifnonnull,if_icmpeq,if_icmpene,if_icmplt,if_icmpgt,if_icmple,if_icmpge,<br>if_acmpeq,if_acmpne,lcmp,fcmpl,fcmpg,dcmpl,dcmpg<br>复合条件转移：tableswitch,lookupswitch<br>无条件转移：goto,goto_w,jsr,jsr_w,ret<br>调度对象的实便方法：invokevirt l<br>调用由接口实现的方法：invokeinterface<br>调用需要特殊处理的实例方法：invokespecial<br>调用命名类中的静态方法：invokestatic<br>方法返回：ireturn,lreturn,freturn,dreturn,areturn,return<br>异常：athrow<br>finally关键字的实现使用：jsr,jsr_w,ret  </p>

	
	</div>
  <a type="button" href="/2017/06/16/Java——Java虚拟机指令集/#more" class="btn btn-default more">阅读此文</a>
</div>

           
		
           
			  
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2017-06-10 </div>
			<div class="article-title"><a href="/2017/06/10/设计模式——工厂模式（2）：工厂方法模式/" title="本文为工厂模式整理的第二篇，主要介绍工厂方法模式。工厂方法模式是面向对象编程中常用的一种模式，它能够使代码结构清晰，降低耦合度。">设计模式——工厂模式（2）：工厂方法模式</a></div>						
		</h3>
	


			  <div class="entry">
  <div class="row">
	
	
		<p>&emsp;&emsp;工厂模式根据其抽象程度的逐步提高可以分为简单工厂、工厂方法模式和抽象工厂模式。关于简单工厂，可以移步我的另一篇博文<a href="/2017/06/01/设计模式——工厂模式（1）：简单工厂/">设计模式——工厂模式（1）：简单工厂</a>。本文介绍第二种：工厂方法模式。<br><code>注意：本文中所提到的“接口”，并非仅指java中的interface，也包括抽象类、抽象方法等。</code></p>
<h1 id="工厂方法模式概念"><a href="#工厂方法模式概念" class="headerlink" title="工厂方法模式概念"></a>工厂方法模式概念</h1><p>&emsp;&emsp;工厂方法模式定义了一个创建产品对象的工厂接口，由子类决定要实例化的类是哪一个，它将实际创建工作推迟到子类当中。核心工厂类成为一个抽象工厂角色，仅表示具体工厂子类必须实现的接口。工厂方法模式是简单工厂基础上的进一步抽象，进一步抽象化的好处是使得工厂方法模式可以使系统在不修改具体工厂角色的情况下引进新的产品或者是增加新的工厂。<br>&emsp;&emsp;工厂方法模式的<strong>核心思想是：封装类中不变的部分，提取其中个性化善变的部分为独立类，通过依赖注入以达到解耦、复用和方便后期维护拓展的目的。</strong></p>
<h1 id="工厂方法模式要素"><a href="#工厂方法模式要素" class="headerlink" title="工厂方法模式要素"></a>工厂方法模式要素</h1><p>&emsp;&emsp;工厂方法模式共有四个要素，如下图所示：  </p>
<p align="center"><br><img src="http://odnk9as2f.bkt.clouddn.com/FactoryMethodPattern1.png" alt="工厂方法模式要素"><br></p>

<p>具体要素为：  </p>
<ul>
<li>工厂接口<em><code>Creator</code></em>，它是工厂方法模式的核心。它实现了操纵产品的方法<code>anOperation()</code>，同时定义了一个抽象的<strong>工厂方法*</strong><code>factoryMethod()</code>*，它不实现工厂方法而是留给子类去实现。</li>
<li>具体工厂实现<code>ConcretCreator</code>，它实现了工厂接口的抽象的工厂方法<code>factoryMethod()</code>，以决定如何创造具体的产品。有多少种产品，就要有多少个具体的工厂实现。</li>
<li>产品接口<em><code>Product</code></em>，它定义了产品的规范，所有产品必须实现这个共同的接口，这样一来使用这些产品的类就可以引用这个接口，而不是具体类。调用者关心的是产品接口而非具体的产品。</li>
<li>具体产品实现<code>ConcretProduct</code>，它是实现产品的具体类。</li>
</ul>
<h1 id="工厂方法模式示例"><a href="#工厂方法模式示例" class="headerlink" title="工厂方法模式示例"></a>工厂方法模式示例</h1><p>&emsp;&emsp;根据上一节中的工厂方法模式的四要素，我们假设这样一个场景：比萨类型有两个种类：<strong>纽约风味比萨</strong>和<strong>芝加哥风味比萨</strong>，不同的风味下又各有四个不同原料的比萨，纽约和芝加哥两地均有比萨店的分店，需要提供以上两类的四个不同原料的比萨。让我们来看看类图：</p>
<p></p><p align="center"><br><img src="http://odnk9as2f.bkt.clouddn.com/FactoryMethodPattern2.png" alt="Pizza工厂示例类图"><br></p><br>&emsp;&emsp;下面将以令纽约比萨分店<code>NYStylePizzaStore</code>创建纽约风味的cheese比萨<code>NYStyleCheesePizza</code>为例，来实现我们的工厂方法模式的demo：<p></p>
<ul>
<li>工厂接口：<em><code>PizzaStore</code></em>类：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.edu.whu;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 抽象工厂类</span></span><br><span class="line"><span class="comment"> * Created by wuwenan on 10/06/2017.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">PizzaStore</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Pizza <span class="title">orderPizza</span><span class="params">(String type)</span> </span>&#123;</span><br><span class="line">        Pizza pizza;</span><br><span class="line"></span><br><span class="line">        pizza = createPizza(type);</span><br><span class="line"></span><br><span class="line">        pizza.prepare();</span><br><span class="line">        pizza.bake();</span><br><span class="line">        pizza.cut();</span><br><span class="line">        pizza.box();</span><br><span class="line">        <span class="keyword">return</span> pizza;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//工厂方法，让子类实现</span></span><br><span class="line">    <span class="function"><span class="keyword">abstract</span> Pizza <span class="title">createPizza</span><span class="params">(String type)</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>具体工厂实现类：<code>NYStylePizzaStore</code>：  </li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.edu.whu;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 具体工厂类</span></span><br><span class="line"><span class="comment"> * Created by wuwenan on 10/06/2017.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NYStylePizzaStore</span> <span class="keyword">extends</span> <span class="title">PizzaStore</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function">Pizza <span class="title">createPizza</span><span class="params">(String item)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (item.equals(<span class="string">"cheese"</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> NYStyleCheesePizza();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (item.equals(<span class="string">"veggie"</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> NYStyleVeggiePizza();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (item.equals(<span class="string">"clam"</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> NYStyleClamPizza();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (item.equals(<span class="string">"pepperoni"</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> NYStylePepperoniPizza();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>产品接口：<em><code>Pizza</code></em>类：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.edu.whu;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 抽象产品类</span></span><br><span class="line"><span class="comment"> * Created by wuwenan on 02/06/2017.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Pizza</span> </span>&#123;</span><br><span class="line">    String name; <span class="comment">//比萨名</span></span><br><span class="line">    String dough; <span class="comment">//使用的面团</span></span><br><span class="line">    String sauce; <span class="comment">//使用的酱料</span></span><br><span class="line">    ArrayList toppings = <span class="keyword">new</span> ArrayList(); <span class="comment">//使用的佐料</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">prepare</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Preparing "</span> + name);</span><br><span class="line">        System.out.println(<span class="string">"Tossing dough..."</span>);</span><br><span class="line">        System.out.println(<span class="string">"Adding sauce..."</span>);</span><br><span class="line">        System.out.println(<span class="string">"Adding toppings: "</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;toppings.size();i++) &#123;</span><br><span class="line">            System.out.println(<span class="string">"  "</span> + toppings.get(i));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">bake</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Baking..."</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">cut</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Cutting the pizza..."</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">box</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Placing the pizza in box..."</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>具体产品实现类：<code>NYStyleCheesePizza</code>  </li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.edu.whu;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 具体产品类</span></span><br><span class="line"><span class="comment"> * Created by wuwenan on 10/06/2017.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NYStyleCheesePizza</span> <span class="keyword">extends</span> <span class="title">Pizza</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">NYStyleCheesePizza</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        name = <span class="string">"NY Style Cheese Pizza"</span>;</span><br><span class="line">        dough = <span class="string">"NY Style Cheese Pizza dough"</span>;</span><br><span class="line">        sauce = <span class="string">"NY Style Cheese Pizza sauce"</span>;</span><br><span class="line"></span><br><span class="line">        toppings.add(<span class="string">"NY Style Cheese Pizza topping1"</span>);</span><br><span class="line">        toppings.add(<span class="string">"NY Style Cheese Pizza topping2"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>测试类：<code>PizzaTest</code></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.edu.whu;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 测试类</span></span><br><span class="line"><span class="comment"> * Created by wuwenan on 10/06/2017.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PizzaTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        PizzaStore nyPizzaStore = <span class="keyword">new</span> NYStylePizzaStore();</span><br><span class="line">        String pizzaType = <span class="string">"cheese"</span>;</span><br><span class="line">        System.out.println(<span class="string">"要创建的比萨类型是："</span> + pizzaType);</span><br><span class="line">        nyPizzaStore.orderPizza(pizzaType);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>输出结果为：  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">要创建的比萨类型是：cheese</span><br><span class="line">Preparing NY Style Cheese Pizza</span><br><span class="line">Tossing dough...</span><br><span class="line">Adding sauce...</span><br><span class="line">Adding toppings: </span><br><span class="line">  NY Style Cheese Pizza topping1</span><br><span class="line">  NY Style Cheese Pizza topping2</span><br><span class="line">Baking...</span><br><span class="line">Cutting the pizza...</span><br><span class="line">Placing the pizza in box...</span><br></pre></td></tr></table></figure>
<p>PS：以上代码已上传至我的Github，地址是：<a href="https://github.com/Wanz2/DesignPatterns" target="_blank" rel="noopener">https://github.com/Wanz2/DesignPatterns</a></p>

	
	</div>
  <a type="button" href="/2017/06/10/设计模式——工厂模式（2）：工厂方法模式/#more" class="btn btn-default more">阅读此文</a>
</div>

           
		

		</div>

		<!-- pagination -->
		<div>
  		<center>
		<div class="pagination">
<ul class="pagination">
	 
		
          <li class="prev disabled"><a><i class="fa fa-arrow-circle-o-left"></i>上一页</a></li>
        

        <li><a href="/"><i class="fa fa-home"></i>Home</a></li>

		
		   <li class="next"> <a href="/page/2/" class="alignright next">下一页<i class="fa fa-arrow-circle-o-right"></i></a> </li>          
        
	
</ul>
</div>

  		</center>
		</div>

		
		
	</div> <!-- col-md-9 -->

	
		<div class="col-md-3">
	<div id="sidebar">
	
			
  <div id="site_search">
   <div class="form-group">
    <input type="text" id="local-search-input" name="q" results="0" placeholder="搜索" class="st-search-input st-default-search-input form-control"/>
   </div>  
  <div id="local-search-result"></div>
  </div>


		
			<div class="widget">
    
	    <h4 class="dsq-widget-title">最新留言</h4>
		<div id="recent-comments"></div>
		<script type="text/javascript">
		    getRecentCommentsList({
			   type: "github" ? "github" : "github",
			   user: "wzpan",
               repo: "hexo-theme-freemind-blog",
               client_id: "bf7d4ba11877db88543e",
               client_secret: "bff8a6b06b745c0bfcdccbe225623ea8e2a057bb",
			   count: "5" ? "5" : 5,
			   recent_comments_target: "#recent-comments"
			});
		</script>
	
</div>

		
			
	<div class="widget">
		<h4>分类</h4>
		<ul class="tag_box inline list-unstyled">
		
			<li><a href="/categories/Python/Docker/">Docker<span>1</span></a></li>
		
			<li><a href="/categories/Java/">Java<span>9</span></a></li>
		
			<li><a href="/categories/Linux/">Linux<span>1</span></a></li>
		
			<li><a href="/categories/Python/">Python<span>1</span></a></li>
		
			<li><a href="/categories/Web开发/">Web开发<span>1</span></a></li>
		
			<li><a href="/categories/图像处理/">图像处理<span>1</span></a></li>
		
			<li><a href="/categories/数据库/">数据库<span>1</span></a></li>
		
			<li><a href="/categories/数据结构与算法/">数据结构与算法<span>1</span></a></li>
		
			<li><a href="/categories/机器学习/">机器学习<span>6</span></a></li>
		
			<li><a href="/categories/系统架构/">系统架构<span>1</span></a></li>
		
			<li><a href="/categories/经验心得/">经验心得<span>3</span></a></li>
		
			<li><a href="/categories/设计模式/">设计模式<span>4</span></a></li>
		
		</ul>
	</div>

		
			
	<div class="widget">
		<h4>标签云</h4>
		<ul class="tag_box inline list-unstyled">		
		
			<li><a href="/tags/Java/">Java<span>11</span></a></li>
		
			<li><a href="/tags/泛型/">泛型<span>1</span></a></li>
		
			<li><a href="/tags/Linux/">Linux<span>1</span></a></li>
		
			<li><a href="/tags/设计模式/">设计模式<span>4</span></a></li>
		
			<li><a href="/tags/经验心得/">经验心得<span>4</span></a></li>
		
			<li><a href="/tags/数据结构与算法/">数据结构与算法<span>1</span></a></li>
		
			<li><a href="/tags/机器学习/">机器学习<span>6</span></a></li>
		
			<li><a href="/tags/图像处理/">图像处理<span>1</span></a></li>
		
			<li><a href="/tags/Web开发/">Web开发<span>1</span></a></li>
		
			<li><a href="/tags/系统架构/">系统架构<span>1</span></a></li>
		
			<li><a href="/tags/Docker/">Docker<span>1</span></a></li>
		
			<li><a href="/tags/Python/">Python<span>1</span></a></li>
		
			<li><a href="/tags/框架/">框架<span>1</span></a></li>
		
			<li><a href="/tags/数据库/">数据库<span>1</span></a></li>
		
			<li><a href="/tags/Java虚拟机/">Java虚拟机<span>1</span></a></li>
		
		 
		</ul>
	</div>


		
			
<div class="widget">
  <h4>最新文章</h4>
  <ul class="entry list-unstyled">
    
      <li>
        <a href="/2020/06/08/《高效能人士的七个习惯》读书笔记/"  title="《高效能人士的七个习惯》读书笔记" ><i class="fa fa-file-o"></i>《高效能人士的七个习惯》读书笔记</a>
      </li>
    
      <li>
        <a href="/2020/04/20/数据库性能优化分析/"  title="最近负责考虑自己所在项目的数据库性能优化方案，主要是一张大表 **table_a**，预计上线以后会有亿级甚至十亿级数据，需要解决单表数据量过大所带来的性能和管理问题。本文对常用数据库优化方法进行整理、分析和总结，最终给出了适合本项目的数据库优化方案。" ><i class="fa fa-file-o"></i>数据库性能优化方法专题分析</a>
      </li>
    
      <li>
        <a href="/2018/09/13/win10上PyCharm选择本地docker镜像中解释器报NullPointerException解决方案/"  title="在win10中使用PyCharm进行Python开发，通过Docker搭建本地开发环境会比较方便。我在这个过程中遇到了一个纠结了很久的问题，docker-machine启动后，在PyCharm中选择项目解释器时会报异常，同时PyCharm中会显示docker-machine没有运行。" ><i class="fa fa-file-o"></i>win10上PyCharm选择本地docker镜像中解...</a>
      </li>
    
      <li>
        <a href="/2018/06/01/磁盘分区与Ext2文件系统/"  title="磁盘分区与Linux的Ext2文件系统简介。" ><i class="fa fa-file-o"></i>磁盘分区与Ext2文件系统</a>
      </li>
    
      <li>
        <a href="/2017/09/04/FreeMarker模板引擎实战/"  title="FreeMarker是一个模板引擎：它是一个Java库，基于模板和要改变的数据生成输出文本（HTML网页、电子邮件、配置文件、源代码等）。本文通过一个小demo来说明FreeMarker的使用方式。" ><i class="fa fa-file-o"></i>FreeMarker模板引擎实战</a>
      </li>
    
  </ul>
</div>

		
			
<div class="widget">
	<h4>链接</h4>
	<ul class="blogroll list-unstyled">
	
		<li><i class="fa fa-github"></i><a href="https://github.com/wzpan/freemind/" title="Freemind's Github repository." target="_blank"]);">Freemind</a></li>
	
		<li><i class="fa fa-github"></i><a href="http://www.github.com/wzpan" title="My Github account." target="_blank"]);">My Github</a></li>
	
		<li><i class="fa fa-linkedin"></i><a href="http://www.linkedin.com/in/hahack" title="My Linkin account." target="_blank"]);">My LinkedIn</a></li>
	
	</ul>
</div>


		
	</div> <!-- sidebar -->
</div> <!-- col-md-3 -->

	
	
</div> <!-- row-fluid -->


    </div>
  </div>
  <div class="container-narrow">
    <footer> <p>
  &copy; 2020 Aaron Wu
  
      with help from <a href="http://hexo.io/" target="_blank">Hexo</a> and <a href="http://getbootstrap.com/" target="_blank">Twitter Bootstrap</a>. Theme by <a href="http://github.com/wzpan/hexo-theme-freemind/">Freemind</a>.    
</p> </footer>
  </div> <!-- container-narrow -->
  


  
<a id="gotop" href="#">   
  <span>▲</span> 
</a>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
<script src="/js/search.js"></script> 


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>




<!-- syntax highlighting -->

  <script>
  marked.setOptions({
    highlight: function (code, lang) {
        return hljs.highlightAuto(code).value;
    }
  });
  function Highlighting(){
    var markdowns = document.getElementsByClassName('markdown');
    for(var i=0;i<markdowns.length;i++){
        if(markdowns[i].innerHTML) markdowns[i].innerHTML =marked(markdowns[i].innerHTML);
    }
  }
  window.addEventListener('DOMContentLoaded', Highlighting, false);
  window.addEventListener('load', Highlighting, false);
  </script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->


</body>
</html>